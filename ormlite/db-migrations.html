<!doctype html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-7722718-13"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'UA-7722718-13');</script>
    
    <meta charset="utf-8"/>
    <meta name='date' content='2024-09-12T03:56:17.8084810Z'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/svg" href="/img/logo.svg">
    <title>Code-First DB Migrations</title>
    <script>
    if (location.search === "?dark") localStorage.setItem('color-scheme','dark') 
    if (location.search === "?light") localStorage.removeItem('color-scheme') 
    const cls = document.querySelector('html').classList
    if (localStorage.getItem('color-scheme') === 'dark')
        cls.add('dark')
    else
        cls.remove('dark')
    </script>
    <link rel="stylesheet" href="/css/app.css">
    

    <script async src="https://ga.jspm.io/npm:es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
{
    "imports": {
        "app.mjs": "/mjs/app.mjs",
        "vue": "/lib/mjs/vue.min.mjs",
        "@servicestack/client": "/lib/mjs/servicestack-client.min.mjs",
        "@servicestack/vue": "/lib/mjs/servicestack-vue.min.mjs"
    }
}
</script>
</head>
<body class="bg-white dark:bg-black dark:text-white">

<header id="header" class="top-0 fixed z-50 h-14 bg-white dark:bg-black opacity-90 w-full shadow">
  <nav class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-black">
    <div class="mx-auto max-w-[100rem] pr-4 sm:pr-6 lg:pr-8">
      <div class="flex h-16 justify-between">
        <div class="flex">
          <div class="flex flex-shrink-0 items-center">
            <a class="mr-2 lg:mr-8 flex items-center" href="/">
                <svg class="w-8 h-8 sm:ml-2 sm:w-12 sm:h-12" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="currentColor" d="M10 6c1.544 1.76 2.276 4.15 2.217 6.61c3.968 1.67 9.924 6.12 11.181 12.39H28C26.051 14.31 14.918 6.77 10 6zm-2 7c4.67 4.913.81 11.582-4 12h18.97C21.5 18.289 11.95 13.533 8 13z"/></svg>
                <span class="hidden sm:block text-2xl font-semibold">Documentation</span>
            </a>
          </div>
            <div class="hidden sm:-my-px sm:ml-6 sm:flex sm:space-x-4 lg:space-x-8">
                <!-- Current: "border-indigo-500 text-gray-900", Default: "border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" -->
                        <a href="/templates/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            <span class="hidden xl:inline mr-1">Project</span> Templates
                        </a>
                        <a href="/vue/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Vue
                        </a>
                        <a href="/autoquery/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            AutoQuery
                        </a>
                        <a href="/auth/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Auth
                        </a>
                        <a href="/ormlite/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-indigo-500 text-gray-900">
                            OrmLite
                        </a>
                        <a href="/redis/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Redis
                        </a>
                        <a href="/locode/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200 hidden lg:inline-flex">
                            Locode
                        </a>
                        <a href="/grpc/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200 hidden lg:inline-flex">
                            gRPC
                        </a>
            </div>
        </div>
        <div class="hidden sm:ml-6 sm:flex sm:items-center">
            <typesense></typesense>
            <dark-mode-toggle class="ml-2 w-10"></dark-mode-toggle>
        </div>
        <div class="-mr-2 flex items-center sm:hidden">
          <!-- Mobile menu button -->
          <button type="button" v-on:click="open=!open" class="inline-flex items-center justify-center rounded-md bg-white dark:bg-black p-2 text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:ring-offset-black" aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <!-- Menu open: "hidden", Menu closed: "block" -->
            <svg :class="['h-6 w-6', open ? 'hidden' : 'block']" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
            <!-- Menu open: "block", Menu closed: "hidden" -->
            <svg :class="['h-6 w-6', open ? 'block' : 'hidden']" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu, show/hide based on menu state. -->
    <div v-cloak v-if="open" class="sm:hidden">
        <div class="space-y-1 pb-3 pt-2">
            <!-- Current: "border-indigo-500 bg-indigo-50 text-indigo-700", Default: "border-transparent text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800" -->
                    <a href="/templates/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Project Templates
                    </a>
                    <a href="/vue/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Vue
                    </a>
                    <a href="/autoquery/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        AutoQuery
                    </a>
                    <a href="/auth/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Auth
                    </a>
                    <a href="/ormlite/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-indigo-500 bg-indigo-50 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-200">
                        OrmLite
                    </a>
                    <a href="/redis/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Redis
                    </a>
                    <a href="/locode/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Locode
                    </a>
                    <a href="/grpc/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        gRPC
                    </a>
        </div>
    </div>
  </nav>
</header>

<script type="module">
import { ref } from "vue"
import { mount } from "app.mjs"

const Header = {
    setup() {
        const open = ref(false)
        return { open }
    }
}
mount('#header', Header)
</script>


<div class="min-h-screen">
    <main role="main" class="pt-16 pb-3 max-w-[100rem] mx-auto">
        



<style>
.active {
    color: #0ea5e9 !important;
}
</style>
<link rel="stylesheet" href="/css/highlight.css">
<link rel="stylesheet" href="/css/typography.css">
<link rel="stylesheet" href="/css/lite-yt-embed.css">

<div class="w-full max-w-[100rem] mx-auto">
    <div class="flex flex-wrap">
        <div id="sidebar" class="z-40 inset-0 flex-none bg-white dark:bg-black lg:w-64 xl:w-80">
            <button v-cloak v-on:click="open=true" :class="['text-gray-400 hover:text-gray-500 pt-4 pl-2 absolute transform transition-all duration-200', open ? 'opacity-0 translate-x-56' : 'opacity-100']" title="Open Sidebar">
                <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H10m10 0l-4 4m4-4l-4-4M4 4v16"/></svg>
            </button>
            <div :class="['fixed bg-white dark:bg-black h-screen overflow-y-auto scrolling-touch overflow-hidden shadow lg:shadow-none transform transition-transform duration-200', open ? '' : 'translate-x-[-100%]']">
                <nav class="sidebar lg:w-64 xl:w-80 px-1 pt-6 pb-16 overflow-y-auto font-medium text-sm lg:text-base sm:px-3 xl:px-5" aria-label="Sidebar">
                    <close-button title="Close Sidebar" class="lg:hidden -mr-2" v-on:close="open=false"></close-button>
                                <a href="/ormlite/" class="block flex items-center whitespace-nowrap">
<svg class='h-6 w-6 shrink-0 text-sky-500' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor' aria-hidden='true'><path stroke-linecap='round' stroke-linejoin='round' d='M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25'></path></svg>                                    <span class="p-2 pl-3 font-display font-medium text-slate-900 dark:text-white">
OrmLite                                    </span>
                                </a>
                        <ul role="list" class="mb-6 mt-2 ml-3 space-y-2 border-l-2 border-slate-100 dark:border-slate-800 lg:mt-4 lg:space-y-4 lg:border-slate-200">
                                <li class="relative">
                                    <a href="/ormlite/installation" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Installation
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/getting-started" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Getting Started
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/ormlite-apis" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        API Overview
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/async-apis" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Async APIs
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/db-migrations" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full active font-semibold text-sky-500 before:bg-sky-500">
                                        DB Migrations
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/litestream" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Litestream
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/install-postgres-mysql-sqlserver" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Install Postgres, MySql &amp; MSSQL
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/multi-database-app" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Multiple App Databases
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/scalable-sqlite" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Scalable SQLite
                                    </a>
                                </li>
                        </ul>
                                <h2 class="font-display font-medium text-slate-900 dark:text-white whitespace-nowrap">
                                    OrmLite APIs
                                </h2>
                        <ul role="list" class="mb-6 mt-2 ml-3 space-y-2 border-l-2 border-slate-100 dark:border-slate-800 lg:mt-4 lg:space-y-4 lg:border-slate-200">
                                <li class="relative">
                                    <a href="/ormlite/apis/select" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Select APIs
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/apis/insert" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Insert APIs
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/apis/update" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Update APIs
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/apis/delete" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Delete APIs
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/apis/schema" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Schema APIs
                                    </a>
                                </li>
                        </ul>
                                <h2 class="font-display font-medium text-slate-900 dark:text-white whitespace-nowrap">
                                    Advanced Topics
                                </h2>
                        <ul role="list" class="mb-6 mt-2 ml-3 space-y-2 border-l-2 border-slate-100 dark:border-slate-800 lg:mt-4 lg:space-y-4 lg:border-slate-200">
                                <li class="relative">
                                    <a href="/ormlite/bulk-inserts" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Bulk Inserts
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/reference-support" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Reference Support
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/typed-joins" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Typed Join Expressions
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/dynamic-result-sets" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Dynamic Result Sets
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/transactions" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Database Transactions
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/type-converters" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Type Converters
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/ormlite-utils" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        OrmLite Utils
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/ensure-apis" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Ensure APIs
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/introspection" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Logging &amp; Introspection
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/complex-type-serializers" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Complex Type Serializers
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/filters" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Insert &amp; Update Filters
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/custom-sql" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Custom SQL
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/customized-sql-features" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        SQL Customizations
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/dictionary-apis" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Dictionary APIs
                                    </a>
                                </li>
                        </ul>
                                <h2 class="font-display font-medium text-slate-900 dark:text-white whitespace-nowrap">
                                    RDBMS specific features
                                </h2>
                        <ul role="list" class="mb-6 mt-2 ml-3 space-y-2 border-l-2 border-slate-100 dark:border-slate-800 lg:mt-4 lg:space-y-4 lg:border-slate-200">
                                <li class="relative">
                                    <a href="/ormlite/sql-server-features" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        SQL Server Features
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/postgres-features" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        PostgreSQL Features
                                    </a>
                                </li>
                        </ul>
                                <h2 class="font-display font-medium text-slate-900 dark:text-white whitespace-nowrap">
                                    Background Info
                                </h2>
                        <ul role="list" class="mb-6 mt-2 ml-3 space-y-2 border-l-2 border-slate-100 dark:border-slate-800 lg:mt-4 lg:space-y-4 lg:border-slate-200">
                                <li class="relative">
                                    <a href="/ormlite/optimistic-concurrency" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Optimistic Concurrency
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/untyped-apis" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Untyped APIs
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/autogen-t4" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoGen &amp; T4 templates
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/stored-procedures" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Stored Procedures
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/multi-database-connections" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Multi database connections
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/shippers-example" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        OrmLite Shippers example
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/customer-orders-example" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Customer Orders example
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/aws-rds-databases" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AWS &amp; RDS Support
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/ormlite/limitations" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Limitations
                                    </a>
                                </li>
                        </ul>
                </nav>
            </div>
        </div>
        <div id="doc" class="mx-auto flex">
            <div class="mt-8 mx-auto prose lg:prose-lg">
                
                    <section class="not-prose mb-16 md:mb-12">
                        <h1 class="text-4xl tracking-tight font-extrabold text-gray-900 dark:text-gray-50 sm:text-5xl md:text-6xl">
                            Code-First DB Migrations
                        </h1>
                    </section>

                <div class="not-prose"></div>

                <div class="content"><p>OrmLite DB Migrations advances OrmLite's light-weight code-first development approach with a simple <a href="https://www.prisma.io/dataguide/types/relational/what-are-database-migrations#change-based-migrations">change based migration</a> solution that facilitates the code-first development workflow of OrmLite.</p>
<div class="my-8 flex justify-center">
    <lite-youtube class="w-full mx-4 my-4" width="560" height="315" videoid="NIVFqute7JQ" style="background-image: url('https://img.youtube.com/vi/NIVFqute7JQ/maxresdefault.jpg')"></lite-youtube>
</div>
<h2 id="introduction">Introduction<a class="header-anchor" href="javascript:;" onclick="location.hash='#introduction'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>In contrast to <a href="https://www.prisma.io/dataguide/types/relational/what-are-database-migrations#state-based-migrations">state-based migration</a> solutions which relies on tooling to generate state changes from a snapshot of a DB at a point-in-time with schema changes made out-of-band, OrmLite's DB migrations are instead designed to capture and execute the schema changes developers want to make, so when the Migrations are checked-in with the feature that needs them, the same exact changes are run by CI integration servers and other developers syncing their code-base with the new feature.</p>
<p>Instead of relying on generation by an opaque tool, this code-first approach treats DB Migrations like any other maintainable &amp; logically structured code written by developers where it maintains a connected audit history in source control together with the feature that needs the schema changes.</p>
<h2 id="getting-started">Getting Started<a class="header-anchor" href="javascript:;" onclick="location.hash='#getting-started'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>We'll start by looking at the minimum amount of code required for a Migration:</p>
<pre><code class="language-csharp">class Migration1000 : MigrationBase
{
    public override void Up() {}
}
</code></pre>
<p>Which doesn't do anything but shows that the migration class name should adopt a numerical naming convention given class names are what determines the order in which migrations run. It also shows that a compensatory <code>Down()</code> implementation isn't required if you intend to adopt a <strong>&quot;Roll-Forward&quot;</strong> approach where any issues are resolved in subsequent migrations instead of reverting to a previous state so existing migrations can be refactored and re-run.</p>
<h3 id="class-names-used-to-determine-order-of-migrations">Class names used to determine order of Migrations<a class="header-anchor" href="javascript:;" onclick="location.hash='#class-names-used-to-determine-order-of-migrations'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>We've decided upon using class names for determining the order migrations are run as it's important for their sequence to be clearly visible and easily navigable, a trait made possible with files being listed in alphabetical order making it easy to determine the order migrations were run and what the name of the next migration should be, it also gains assistance by the compiler in enforcing duplicates are not possible and source control ensures conflicting migration files are identified before they're checked in and run by CI.</p>
<h2 id="basic-example">Basic Example<a class="header-anchor" href="javascript:;" onclick="location.hash='#basic-example'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>The <code>[Description]</code> or <code>[Notes]</code> attributes can instead be used to provide human-friendly descriptions of each migration where they'll be included in logs and included in the <code>Migration</code> table that's used to capture the execution of each migration.</p>
<p>With the basics covered lets look at using DB Migrations to create our first table:</p>
<pre><code class="language-csharp">[Description(&quot;Create initial database tables&quot;)]
class Migration1000 : MigrationBase
{
    class MyTable
    {
        [AutoIncrement]
        public int Id { get; set; }
        public string Name { get; set; }
        public double ToDelete { get; set; }
    }

    public override void Up() =&gt; Db.CreateTable&lt;MyTable&gt;();
    public override void Down() =&gt; Db.DropTable&lt;MyTable&gt;();
}
</code></pre>
<p>First thing to notice is that the migrations do not reference our App's Data Models because migrations only contains the initial state and the deltas performed in each Migration, the result of which should match our App's Data Models which represent the current Data Models for the latest DB Schema.</p>
<div class="tip custom-block">
            <p class="custom-block-title">TIP</p><p>Initially these will match so you can just copy over all your Data Models as inner classes for your App's <strong>1st Migration</strong></p>
</div>
<h2 id="declarative-code-first-migrations">Declarative Code-First Migrations<a class="header-anchor" href="javascript:;" onclick="location.hash='#declarative-code-first-migrations'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>To improve the typical development workflow your implementations can take advantage of declarative migration support which allows you to copy over new properties in your Data Models you want to <strong>Add</strong>, <strong>Remove</strong> or <strong>Rename</strong> as an alternative for writing procedural statements to perform the same changes with the <a href="/ormlite/apis/schema.html#modify-custom-schema">Modify Schema APIs</a>.</p>
<p>We'll use this feature in our 2nd migration for its Data Model changes where we want to:</p>
<ul>
<li><strong>Add</strong> a new <code>Code</code> VARCHAR column with <strong>Index</strong></li>
<li><strong>Rename</strong> the existing <code>Name</code> column to <code>FullName</code></li>
<li><strong>Delete</strong> the existing <code>ToDelete</code> column</li>
</ul>
<p>For these common use-cases we can use <code>Migrate&lt;Table&gt;</code> to apply schema changes from a declarative class definition or use <code>Revert&lt;Table&gt;</code> to revert them, e.g:</p>
<pre><code class="language-csharp">[Description(&quot;Update MyTable&quot;)]
class Migration1001 : MigrationBase
{    
    class MyTable
    {        
        [Index] //[AddColumn] (Optional default)
        public string Code { get; set; } //new field

        [RenameColumn(&quot;Name&quot;)]
        public string? FullName { get; set; }

        [RemoveColumn]
        public double ToDelete { get; set; }
    }
    
    public override void Up() =&gt; Db.Migrate&lt;MyTable&gt;();
    public override void Down() =&gt; Db.Revert&lt;MyTable&gt;();
}
</code></pre>
<p>In addition to being more productive and readable, it also benefits from being able to infer both schema migration and revert changes from the same declarative definition which is an alternative to using the <a href="/ormlite/apis/schema.html#modify-custom-schema">Modify Schema APIs</a> to perform the same operations:</p>
<pre><code class="language-csharp">[Description(&quot;Update MyTable&quot;)]
class Migration1001 : MigrationBase
{    
    class MyTable
    {        
        [Index]
        public string Code { get; set; }
        public double ToDelete { get; set; }
    }
    
    public override void Up()
    {
        Db.AddColumn&lt;MyTable&gt;(x =&gt; x.Code);
        Db.RenameColumn&lt;MyTable&gt;(&quot;Name&quot;, &quot;FullName&quot;);
        Db.DropColumn&lt;MyTable&gt;(&quot;ToDelete&quot;);
    }

    public override void Down()
    {
        Db.DropColumn&lt;MyTable&gt;(x =&gt; x.Code);
        Db.RenameColumn&lt;MyTable&gt;(&quot;FullName&quot;, &quot;Name&quot;);
        Db.AddColumn&lt;MyTable&gt;(x =&gt; x.ToDelete);
    }
}
</code></pre>
<p>Or for a more dynamic and Type-free approach it can also be rewritten as:</p>
<pre><code class="language-csharp">[Description(&quot;Update MyTable&quot;)]
class Migration1001 : MigrationBase
{    
    public override void Up()
    {
        Db.AddColumn(table:&quot;MyTable&quot;, new FieldDefinition { 
            Name = &quot;Code&quot;, 
            FieldType = typeof(string), 
            IsIndexed = true 
        });
        Db.RenameColumn(table:&quot;MyTable&quot;, oldColumn:&quot;Name&quot;, newColumn:&quot;FullName&quot;);
        Db.DropColumn(table:&quot;MyTable&quot;, column:&quot;ToDelete&quot;);
    }

    public override void Down()
    {
        Db.DropColumn(table:&quot;MyTable&quot;, column:&quot;Code&quot;);
        Db.RenameColumn(table:&quot;MyTable&quot;, oldColumn:&quot;FullName&quot;, newColumn:&quot;Name&quot;);
        Db.AddColumn(table:&quot;MyTable&quot;, new FieldDefinition { Name = &quot;ToDelete&quot;, FieldType = typeof(string) });
    }
}
</code></pre>
<p>But our preference is to adopt the declarative approach when possible since it's a better match for code-first development where new or modified columns can be copied over from your App's Data Models to maintain and perform the schema changes. But ultimately you could use anything to implement your migration, from <a href="/ormlite/apis/schema.html#custom-sql">Custom SQL</a> or as <code>Db</code> is just an ADO .NET Connection you could also use other Micro ORM's like <a href="https://github.com/DapperLib/Dapper">Dapper</a> that's also <a href="https://github.com/ServiceStack/ServiceStack/tree/main/ServiceStack.OrmLite/src/ServiceStack.OrmLite/Dapper">built-into OrmLite</a>.</p>
<h3 id="code-first-approach">Code-First approach<a class="header-anchor" href="javascript:;" onclick="location.hash='#code-first-approach'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>To get the most out of DB migrations it's recommended that all schema changes are done through migrations to ensure they end up capturing all schema changes and saves duplicated efforts from having to create Migrations from out-of-band schema changes. It's a more explicit approach than relying on a tool to generate migrations from state diffs, but you'll have more control over how changes are applied and organized together with any populated data required by new features which are tracked together in source control. They're also easier to debug, re-run and refactor during the development cycle of new features.</p>
<h3 id="complex-example">Complex Example<a class="header-anchor" href="javascript:;" onclick="location.hash='#complex-example'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>For a more complex example we'll look at creating an isolated feature that utilizes many of OrmLite's declarative attributes to define a wide class of RDBMS features, that combines both schema creation and seed data within the same migration:</p>
<pre><code class="language-csharp">[Description(&quot;Add Player Feature&quot;)]
public class Migration1002 : MigrationBase
{
    public class Player : AuditBase
    {
        public int Id { get; set; }                     // 'Id' is PrimaryKey by convention

        [Required]
        public string FirstName { get; set; }           // Creates NOT NULL Column

        [Alias(&quot;Surname&quot;)]                              // Maps to [Surname] RDBMS column
        public string LastName { get; set; }

        [Index(Unique = true)]                          // Creates Unique Index
        public string Email { get; set; }

        public List&lt;Phone&gt; PhoneNumbers { get; set; }   // Complex Types blobbed by default

        [Reference]
        public List&lt;GameItem&gt; GameItems { get; set; }   // 1:M Reference Type saved separately

        [Reference]
        public Profile Profile { get; set; }            // 1:1 Reference Type saved separately
        public int ProfileId { get; set; }              // 1:1 Self Ref Id on Parent Table

        [ForeignKey(typeof(Level), OnDelete=&quot;CASCADE&quot;)] // Creates ON DELETE CASCADE Constraint
        public Guid SavedLevelId { get; set; }          // Creates Foreign Key Reference

        public ulong RowVersion { get; set; }           // Optimistic Concurrency Updates
    }

    public class Phone                                  // Blobbed Type only
    {
        public PhoneKind Kind { get; set; }
        public string Number { get; set; }
        public string Ext { get; set; }
    }

    public enum PhoneKind { Home, Mobile, Work }

    [Alias(&quot;PlayerProfile&quot;)]                            // Maps to [PlayerProfile] RDBMS Table
    [CompositeIndex(nameof(Username), nameof(Region))]  // Creates Composite Index
    public class Profile : AuditBase
    {
        [AutoIncrement]                                 // Auto Insert Id assigned by RDBMS
        public int Id { get; set; }

        public PlayerRole Role { get; set; }            // Native support for Enums
        public Region Region { get; set; }
        public string Username { get; set; }
        public long HighScore { get; set; }

        [Default(1)]                                    // Created in RDBMS with DEFAULT (1)
        public long GamesPlayed { get; set; }

        [CheckConstraint(&quot;Energy BETWEEN 0 AND 100&quot;)]   // Creates RDBMS Check Constraint
        public short Energy { get; set; }

        public string ProfileUrl { get; set; }
        public Dictionary&lt;string, string&gt; Meta { get; set; }
    }
    
                                                        // Enums saved as strings by default
    public enum PlayerRole { Leader, Player, NonPlayer }

    [EnumAsInt]                                         // Enum Saved as int
    public enum Region { Africa = 1, Americas = 2, Asia = 3, Australasia = 4, Europe = 5 }

    public class GameItem
    {
        [PrimaryKey]                                    // Specify field to use as Primary Key
        [StringLength(50)]                              // Creates VARCHAR COLUMN
        public string Name { get; set; }

        public int PlayerId { get; set; }               // Foreign Table Reference Id

        [StringLength(StringLengthAttribute.MaxText)]   // Creates &quot;TEXT&quot; RDBMS Column 
        public string Description { get; set; }

        [Default(OrmLiteVariables.SystemUtc)]           // Populated with UTC Date by RDBMS
        public DateTime DateAdded { get; set; }
    }

    public class Level
    {
        public Guid Id { get; set; }                    // Unique Identifier/GUID Primary Key
        public byte[] Data { get; set; }                // Saved as BLOB/Binary where possible
    }
    private string by = &quot;admin@email.com&quot;;

    public override void Up()
    {
        //CREATE ForeignKey Tables in dependent order
        Db.CreateTable&lt;Level&gt;();
        Db.CreateTable&lt;Player&gt;();

        //CREATE tables without Foreign Keys in any order
        Db.CreateTable&lt;Profile&gt;();
        Db.CreateTable&lt;GameItem&gt;();

        var savedLevel = new Level {
            Id = Guid.NewGuid(),
            Data = new byte[]{ 1, 2, 3, 4, 5 },
        };
        Db.Insert(savedLevel);

        var player = new Player
        {
            Id = 1,
            FirstName = &quot;North&quot;,
            LastName = &quot;West&quot;,
            Email = &quot;north@west.com&quot;,
            PhoneNumbers = new List&lt;Phone&gt; {
                new() { Kind = PhoneKind.Mobile, Number = &quot;123-555-5555&quot; },
                new() { Kind = PhoneKind.Home,   Number = &quot;555-555-5555&quot;, Ext = &quot;123&quot; },
            },
            GameItems = new List&lt;GameItem&gt; {
                new() { Name = &quot;WAND&quot;, Description = &quot;Golden Wand of Odyssey&quot;},
                new() { Name = &quot;STAFF&quot;, Description = &quot;Staff of the Magi&quot;},
            },
            Profile = new Profile {
                Username = &quot;north&quot;,
                Role = PlayerRole.Leader,
                Region = Region.Australasia,
                HighScore = 100,
                GamesPlayed = 10,
                ProfileUrl = &quot;https://images.unsplash.com/photo-1463453091185-61582044d556?w=1024&amp;h=1024&quot;,
                Meta = new() {
                    { &quot;Quote&quot;, &quot;I am gamer&quot; }
                },
            }.WithAudit(by),
            SavedLevelId = savedLevel.Id,
        }.WithAudit(by);
        Db.Save(player, references: true);
    }
    
    public override void Down()
    {
        // Clear FK Data
        Db.DeleteAll&lt;Level&gt;();

        // DROP ForeignKey Tables in dependent order
        Db.DropTable&lt;Level&gt;();
        Db.DropTable&lt;Player&gt;();

        // DROP tables without Foreign Keys in any order
        Db.DropTable&lt;Profile&gt;();
        Db.DropTable&lt;GameItem&gt;();
    }
}
</code></pre>
<p>Essentially showing the App Data Models for the initial version of a feature can be copied into a Migration class to perform the required database changes.</p>
<h3 id="reverting-migrations">Reverting Migrations<a class="header-anchor" href="javascript:;" onclick="location.hash='#reverting-migrations'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Implementing <code>Down()</code> is optional but required if you ever intend to revert, refactor then reapply migrations. Alternatively this can be avoided by adopting a <strong>&quot;roll-forward&quot;</strong> approach where any issues with a migration would be resolved in the next one. Whilst this can save some dev effort it would prevent you from reverting, refactoring then reapplying migrations during development and before checking-in a finalized feature.</p>
<p>Migrations are executed within a transaction that's rolled back if it fails, however you should be aware of the limitations of your RDBMS, e.g. <a href="https://dev.mysql.com/doc/refman/8.0/en/atomic-ddl.html#atomic-ddl-supported-statements">newer MySQL versions has caveats on DDL Statements</a> which can be rolled back, but otherwise it's fairly well supported on PostgreSQL, SQL Server &amp; SQLite.</p>
<p>In most cases you'll be able to revert &amp; rerun migrations however you should be mindful that some operations aren't completely reversible, e.g. if you remove a column then revert to add it again, the data in the column will be lost.</p>
<h2 id="running-migrations">Running Migrations<a class="header-anchor" href="javascript:;" onclick="location.hash='#running-migrations'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>To support multiple use-cases, Migrations can easily be run from the command-line or from code which you can use to run or debug migrations from Unit tests.</p>
<h3 id="run-or-debug-migrations-from-your-ide">Run or Debug Migrations from your IDE<a class="header-anchor" href="javascript:;" onclick="location.hash='#run-or-debug-migrations-from-your-ide'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>A benefit of DB Migrations being implemented in a library is that it's better integrated and more versatile in supporting more executable options like being able to run from code which many project templates benefit from with new <code>MigrationTasks</code> Explicit TestFixture enabling DB Migrations to be run or debugged directly from within your IDE, implemented as:</p>
<pre><code class="language-csharp">[TestFixture, Explicit, Category(nameof(MigrationTasks))]
public class MigrationTasks
{
   IDbConnectionFactory ResolveDbFactory() =&gt; new ConfigureDb().ConfigureAndResolve&lt;IDbConnectionFactory&gt;();
   Migrator CreateMigrator() =&gt; new(ResolveDbFactory(), typeof(Migration1000).Assembly); 
   
   [Test]
   public void Migrate()
   {
       var migrator = CreateMigrator();
       var result = migrator.Run();
       Assert.That(result.Succeeded);
   }

   [Test]
   public void Revert_All()
   {
       var migrator = CreateMigrator();
       var result = migrator.Revert(Migrator.All);
       Assert.That(result.Succeeded);
   }

   [Test]
   public void Revert_Last()
   {
       var migrator = CreateMigrator();
       var result = migrator.Revert(Migrator.Last);
       Assert.That(result.Succeeded);
   }

   [Test]
   public void Rerun_Last_Migration()
   {
       Revert_Last();
       Migrate();
   }
}
</code></pre>
<p>Which uses your App's <code>ConfigureDb</code> <a href="/modular-startup">Modular Startup</a> configuration to resolve your App's configured <code>OrmLiteConnectionFactory</code> that the migrations are run against, that if needed can be run from Unit tests to debug through any schema migration issues.</p>
<h4 id="revert-and-rerun-last-migration">Revert and Rerun Last Migration<a class="header-anchor" href="javascript:;" onclick="location.hash='#revert-and-rerun-last-migration'" aria-label="Permalink">&ZeroWidthSpace;</a></h4>
<p>The <code>Rerun_Last_Migration</code> task is especially useful during development of new features to easily revert and rerun the last migration before checking in a completed feature, allowing you to re-iterate and check in a completed and tested DB migration along with the new feature requiring it instead of multiple &quot;micro migrations&quot; for each DB change run at different times.</p>
<h2 id="running-migrations-from-command-line">Running migrations from command-line<a class="header-anchor" href="javascript:;" onclick="location.hash='#running-migrations-from-command-line'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>To be able to run from migrations from the command line, DB Migrations needs access to your App's DB configuration. The best way to do this is to run your App normally then access the configured <code>IDbConnectionFactory</code> from the IOC, perform the migrations then exit with either a success or failure error code.</p>
<p>To do this we've added support for <strong>AppTasks</strong> which let you define tasks in your App that you can run from the command-line. This will let you perform migrations in a separate stage to check migrations were successful before running your App.</p>
<h3 id="configuring-existing-projects">Configuring existing Projects<a class="header-anchor" href="javascript:;" onclick="location.hash='#configuring-existing-projects'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>You can add DB Migration support to existing projects by applying the <a href="https://gist.github.com/gistlyn/50df00df4b3b9faa94a73d32ab4b2484">migrations</a> gist to your project with:</p>
<div class="not-prose sh-copy cp flex cursor-pointer mb-3" onclick="copy(this)">
                <div class="flex-grow bg-gray-800">
                    <div class="pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"><p>x mix migrations</p>
</div>
                    </div>
                <div class="flex">
                    <div class="bg-green-600 text-white p-1.5 pb-0">
                        <svg class="copied w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        <svg class="nocopy w-6 h-6" title="copy" fill='none' stroke='white' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2'></path>
                        </svg>
                    </div>
                </div>
            </div>
<p>This will register the Migration <strong>AppTasks</strong> with your App via a <a href="/modular-startup">Modular Startup</a> configuration:</p>
<pre><code class="language-csharp">public class ConfigureDbMigrations : IHostingStartup
{
    public void Configure(IWebHostBuilder builder) =&gt; builder
        .ConfigureAppHost(afterAppHostInit:appHost =&gt; {
            var migrator = new Migrator(appHost.Resolve&lt;IDbConnectionFactory&gt;(), typeof(Migration1000).Assembly);
            AppTasks.Register(&quot;migrate&quot;, _ =&gt; migrator.Run());
            AppTasks.Register(&quot;migrate.revert&quot;, args =&gt; migrator.Revert(args[0]));
            AppTasks.Run();
        });
}
</code></pre>
<p>Here we can see we need to configure our <code>Migrator</code> with the <code>IDbConnectionFactory</code> we want to run against and the assemblies where all our Migration classes are maintained. It also registers an AppTasks to <strong>migrate</strong> our App by comparing the <strong>Migration</strong> table with the Migrations in the specified Assembly to workout which Migrations are left to run (in order) and the <strong>revert</strong> AppTask to do the opposite and revert to the specified migration.</p>
<p>This will now let us run your app in <strong>&quot;Task Mode&quot;</strong> where it will execute the specified task before promptly exiting with a <strong>0</strong> success exit code if successful or the index of the task that failed, e.g. <strong>1</strong> if the first Task failed.</p>
<h3 id="dotnet-migration-tasks">dotnet Migration Tasks<a class="header-anchor" href="javascript:;" onclick="location.hash='#dotnet-migration-tasks'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>We can then execute our App Task by running our App with the <code>AppTasks</code> command-line argument of the Task we want to run, so we can run all pending migrations with:</p>
<div class="not-prose sh-copy cp flex cursor-pointer mb-3" onclick="copy(this)">
                <div class="flex-grow bg-gray-800">
                    <div class="pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"><p>dotnet run --AppTasks=migrate</p>
</div>
                    </div>
                <div class="flex">
                    <div class="bg-green-600 text-white p-1.5 pb-0">
                        <svg class="copied w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        <svg class="nocopy w-6 h-6" title="copy" fill='none' stroke='white' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2'></path>
                        </svg>
                    </div>
                </div>
            </div>
<p>The format to revert a migration is:</p>
<div class="not-prose sh-copy cp flex cursor-pointer mb-3" onclick="copy(this)">
                <div class="flex-grow bg-gray-800">
                    <div class="pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"><p>dotnet run --AppTasks=migrate.revert:<name></p>
</div>
                    </div>
                <div class="flex">
                    <div class="bg-green-600 text-white p-1.5 pb-0">
                        <svg class="copied w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        <svg class="nocopy w-6 h-6" title="copy" fill='none' stroke='white' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2'></path>
                        </svg>
                    </div>
                </div>
            </div>
<p>Where <strong>name</strong> is either the class name of the Migration you want to revert to (inclusive) or you can use <strong>last</strong> to revert the last migration:</p>
<div class="not-prose sh-copy cp flex cursor-pointer mb-3" onclick="copy(this)">
                <div class="flex-grow bg-gray-800">
                    <div class="pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"><p>dotnet run --AppTasks=migrate.revert:last</p>
</div>
                    </div>
                <div class="flex">
                    <div class="bg-green-600 text-white p-1.5 pb-0">
                        <svg class="copied w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        <svg class="nocopy w-6 h-6" title="copy" fill='none' stroke='white' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2'></path>
                        </svg>
                    </div>
                </div>
            </div>
<p>or <strong>all</strong> to revert all migrations:</p>
<div class="not-prose sh-copy cp flex cursor-pointer mb-3" onclick="copy(this)">
                <div class="flex-grow bg-gray-800">
                    <div class="pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"><p>dotnet run --AppTasks=migrate.revert:all</p>
</div>
                    </div>
                <div class="flex">
                    <div class="bg-green-600 text-white p-1.5 pb-0">
                        <svg class="copied w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        <svg class="nocopy w-6 h-6" title="copy" fill='none' stroke='white' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2'></path>
                        </svg>
                    </div>
                </div>
            </div>
<h3 id="npm-migration-scripts">npm Migration Scripts<a class="header-anchor" href="javascript:;" onclick="location.hash='#npm-migration-scripts'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>To make this easier to remember and use, these tasks are also added as npm scripts:</p>
<pre><code class="language-json">{
  &quot;scripts&quot;: {
    &quot;migrate&quot;: &quot;dotnet run --AppTasks=migrate&quot;,
    &quot;revert:last&quot;: &quot;dotnet run --AppTasks=migrate.revert:last&quot;,
    &quot;revert:all&quot;: &quot;dotnet run --AppTasks=migrate.revert:all&quot;,
    &quot;rerun:last&quot;: &quot;npm run revert:last &amp;&amp; npm run migrate&quot;
  }
}
</code></pre>
<p>Which can be run with:</p>
<pre><code class="language-bash">$ npm run migrate
$ npm run revert:last
$ npm run revert:all
$ npm run rerun:last
</code></pre>
<p>Which Rider provides a nice UX for running directly from the IDE where it will print all executed SQL output in a dedicated Console:</p>
<p><img src="/img/pages/ormlite/migration-scripts.png" alt="" /></p>
<h3 id="asp.net-core-projects">ASP .NET Core Projects<a class="header-anchor" href="javascript:;" onclick="location.hash='#asp.net-core-projects'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>General (i.e. non-ServiceStack) ASP.NET Core Apps can instead configure AppTasks before <code>app.Run()</code> in their <strong>Program.cs</strong>:</p>
<pre><code class="language-csharp">var migrator = new Migrator(app.Services.Resolve&lt;IDbConnectionFactory&gt;(), typeof(Migrations.Migration1000).Assembly);
AppTasks.Register(&quot;migrate&quot;, _ =&gt; migrator.Run());
AppTasks.Register(&quot;migrate.revert&quot;, args =&gt; migrator.Revert(args[0]));
AppTasks.Run();

app.Run();
</code></pre>
<h3 id="new-rdbms-projects-configured-with-db-migrations-by-default">New RDBMS Projects configured with DB Migrations by default<a class="header-anchor" href="javascript:;" onclick="location.hash='#new-rdbms-projects-configured-with-db-migrations-by-default'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Now that OrmLite has a formal solution for implementing and executing schema changes, the <a href="/ormlite/installation.html#quick-install-in-asp-net-core-with-mix">Quick install RDBMS mix scripts</a>
are now configured to include <strong>migrations</strong> by default.</p>
<h3 id="run-ormlite-and-entity-framework-migrations-together">Run OrmLite and Entity Framework Migrations together<a class="header-anchor" href="javascript:;" onclick="location.hash='#run-ormlite-and-entity-framework-migrations-together'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>For convenience if you're using both Entity Framework and OrmLite within the same project you can change the <code>npm run migrate</code>
AppTask to run both Entity Framework and OrmLite Migrations by expanding the AppTask to run EF Migrations:</p>
<pre><code class="language-csharp">public class ConfigureDbMigrations : IHostingStartup
{
    public void Configure(IWebHostBuilder builder) =&gt; builder
        .ConfigureAppHost(appHost =&gt; {
            var migrator = new Migrator(appHost.Resolve&lt;IDbConnectionFactory&gt;(), typeof(Migration1000).Assembly);
            AppTasks.Register(&quot;migrate&quot;, _ =&gt;
            {
                var log = appHost.GetApplicationServices().GetRequiredService&lt;ILogger&lt;ConfigureDbMigrations&gt;&gt;();
                log.LogInformation(&quot;Running EF Migrations...&quot;);
                var scopeFactory = appHost.GetApplicationServices().GetRequiredService&lt;IServiceScopeFactory&gt;();
                using (var scope = scopeFactory.CreateScope())
                {
                    using var db = scope.ServiceProvider.GetRequiredService&lt;ApplicationDbContext&gt;();
                    db.Database.EnsureCreated();
                    db.Database.Migrate();
                }
                log.LogInformation(&quot;Running OrmLite Migrations...&quot;);
                migrator.Run();
            });
            AppTasks.Register(&quot;migrate.revert&quot;, args =&gt; migrator.Revert(args[0]));
            AppTasks.Run();
        });
}
</code></pre>
<h2 id="running-migrations-from-github-actions">Running migrations from GitHub Actions<a class="header-anchor" href="javascript:;" onclick="location.hash='#running-migrations-from-github-actions'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Where applicable, <a href="/github-action-templates">GitHub Action deployments</a> have been updated to automatically run on deployment before the new
version of your application starts up. This is done in the <strong>Run remote db migrations</strong> step.</p>
<p>Output can be found in your GitHub Action run output. The task that is run is controlled in the <code>.deploy/docker-compose-template.yml</code>
file as a separate service which is only run if specified directly or with the <code>--profiles migration</code> option.</p>
<div class="info custom-block">
            <p class="custom-block-title">INFO</p><p>If you are using the template GitHub Actions and deploying to an Ubuntu 22.04 server, ensure you ssh key is generated using non RSA SHA1 algorithm.
Eg <code>ssh-keygen -t ecdsa</code> or swap out the use of <code>appleboy/scp-action@v0.1.3</code> for your own step using the latest version of the <code>scp</code> command line tool in your CI environment.
For a step by step and other options, see <a href="https://askubuntu.com/a/1409528/366659">this Ask Ubuntu Answer</a></p>
</div>
<p>This migration approach enables an easy way to test your migration with a custom local docker compose file. Such as the following for a SQLite setup.</p>
<pre><code class="language-yaml">version: &quot;3.9&quot;
services:
  myapp-migration:
    build: .
    restart: &quot;no&quot;
    command: --AppTasks=migrate
    volumes:
      - myapp-mydb:/app/App_Data

volumes:
  myapp-mydb:
</code></pre>
<div class="info custom-block">
            <p class="custom-block-title">INFO</p><p>Ensure you have v2+ of Docker Compose
A compatibility script can be used for <code>docker-compose</code> via the following script.
<code>echo 'docker compose --compatibility &quot;$@&quot;' &gt; /usr/local/bin/docker-compose</code>
<code>sudo chmod +x /bin/docker-compose</code></p>
</div>
<h3 id="failed-migration-behavior">Failed migration behavior<a class="header-anchor" href="javascript:;" onclick="location.hash='#failed-migration-behavior'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Executing migrations from the command-line is also how they are run in CI. The strategy we've employed in our
<a href="/github-action-templates">GitHub Action Deployment Templates</a> is to run the container to execute the <strong>migrate</strong> AppTask on the host
machine first to validate migration was successful before completing deployment of the new App, so that a failed migration
will cause deployment to fail and the previous App version to continue to run.</p>
<div class="info custom-block">
            <p class="custom-block-title">INFO</p><p>Ensure you are using Docker Compose v2+ and <code>--exit-code-from</code> the migration service in the <code>release.yml</code> file, in the
<code>Run remote db migrations</code> step.</p>
</div>
<h2 id="running-migrations-from-unit-tests">Running migrations from unit tests<a class="header-anchor" href="javascript:;" onclick="location.hash='#running-migrations-from-unit-tests'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>The migration printed in the console output and captured in the <strong>Migration</strong> table should typically be enough to identify any issues, but should it be needed you can also debug Migrations in a unit test with:</p>
<pre><code class="language-csharp">var migrator = new Migrator(DbFactory, typeof(Migration1000).Assembly);
var result = migrator.Run();

result.Succeeded // true if successful
result.TasksRun  // instances of MigrationBase run, can inspect `Error` for failed Exceptions and `Log` for executed SQL
result.TypesCompleted // Migration Types successfully completed
</code></pre>
<p>Likewise uou can revert using the <code>Revert()</code> method which accepts the same options as the command-line, e.g. Migration Type name, <strong>&quot;all&quot;</strong> or <strong>&quot;last&quot;</strong>:</p>
<pre><code class="language-csharp">var result = migrator.Revert(Migrator.All);
</code></pre>
<h2 id="running-migrations-individually">Running Migrations individually<a class="header-anchor" href="javascript:;" onclick="location.hash='#running-migrations-individually'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Should you ever need to, you can also run individual Migrations with the static <code>Up()</code> and <code>Down()</code> methods, e.g:</p>
<pre><code class="language-csharp">Migrator.Up(DbFactory,   new[]{ typeof(Migration1000), typeof(Migration1001) });
Migrator.Down(DbFactory, new[]{ typeof(Migration1001), typeof(Migration1000) });
</code></pre>
<p>These lets you execute migration logic out-of-band where they'll have no impact on the <strong>Migration</strong> table which can be useful in developing &amp; iterating migration implementations by removing/re-adding a feature's schema changes without impacting migration state.</p>
<h3 id="clearing-migration-state">Clearing Migration State<a class="header-anchor" href="javascript:;" onclick="location.hash='#clearing-migration-state'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>To clear your migration table at the start of tests, run:</p>
<pre><code class="language-csharp">var db = DbFactory.Open();
Migrator.Clear(db);
</code></pre>
<h3 id="running-migrations-on-named-connections">Running Migrations on Named Connections<a class="header-anchor" href="javascript:;" onclick="location.hash='#running-migrations-on-named-connections'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>By default the Migration's <code>base.Db</code> connection is configured to use the primary database's connection string, e.g:</p>
<pre><code class="language-csharp">var dbFactory = new OrmLiteConnectionFactory(
    Configuration.GetConnectionString(&quot;DefaultConnection&quot;), PostgreSqlDialect.Provider);    
services.AddSingleton&lt;IDbConnectionFactory&gt;(dbFactory);
</code></pre>
<p>But if your App has <a href="/ormlite/getting-started#multiple-database-connections">Multiple database connections</a> that you need to run migrations on, e.g:</p>
<pre><code class="language-csharp">dbFactory.RegisterConnection(&quot;Sales&quot;, Configuration.GetConnectionString(&quot;Sales&quot;), SqlServer2012Dialect.Provider);
dbFactory.RegisterConnection(&quot;Reporting&quot;, &quot;reporting.sqlite&quot;, SqliteDialect.Provider);
</code></pre>
<p>You can configure the Migration <code>base.Db</code> connection to be configured to use a named connection with the <code>[NamedConnection]</code> attribute, e.g:</p>
<pre><code class="language-csharp">[NamedConnection(&quot;Sales&quot;)]
class Migration1000 : MigrationBase
{
    class Order
    {
        public decimal Freight { get; set; }
    }

    public override void Up() =&gt; Db.Migrate&lt;Order&gt;();
    public override void Down() =&gt; Db.Revert&lt;Order&gt;();
}
</code></pre>
<p>Where you would maintain schema changes to different Databases in different Migrations, alternatively you could use <code>base.DbFactory</code> to create connections to named connections within the same Migration, e.g:</p>
<pre><code class="language-csharp">class Migration1000 : MigrationBase
{
    class Order
    {
        public decimal Freight { get; set; }
    }

    class Subscription
    {
        public string Referral { get; set; }
    }

    public override void Up()
    {
        using var dbSales = DbFactory.Open(&quot;Sales&quot;);
        dbSales.Migrate&lt;Order&gt;();

        using var dbReporting = DbFactory.Open(&quot;Reporting&quot;);
        dbReporting.Migrate&lt;Subscription&gt;();
    }

    public override void Down()
    {
        using var dbSales = DbFactory.Open(&quot;Sales&quot;);
        dbSales.Revert&lt;Order&gt;();

        using var dbReporting = DbFactory.Open(&quot;Reporting&quot;);
        dbReporting.Revert&lt;Subscription&gt;();
    }
}
</code></pre>
<div class="info custom-block">
            <p class="custom-block-title">INFO</p><p>Whilst schema changes are run on different RDBMS's, all migration state is maintained in the <strong>primary database's</strong> <code>Migration</code> table</p>
</div>
<h3 id="multiple-named-connections">Multiple Named Connections<a class="header-anchor" href="javascript:;" onclick="location.hash='#multiple-named-connections'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>DB Migrations also support running and reverting Migrations on multiple named connections, e.g:</p>
<pre><code class="language-csharp">[NamedConnection(&quot;mssql&quot;)]
[NamedConnection(&quot;mysql&quot;)]
[NamedConnection(&quot;postgres&quot;)]
public class Migration1001 : MigrationBase
{
    //...
}
</code></pre>
<p>This feature is likely more useful for maintaining the same schema across multiple database shards, which is a
<a href="https://aws.amazon.com/what-is/database-sharding/">popular scaling technique</a> to increase system capacity and improve response times:</p>
<pre><code class="language-csharp">[NamedConnection(&quot;shard1&quot;)]
[NamedConnection(&quot;shard2&quot;)]
[NamedConnection(&quot;shard3&quot;)]
public class Migration1001 : MigrationBase
{
    //...
}
</code></pre>
<h2 id="reviewing-migrations">Reviewing Migrations<a class="header-anchor" href="javascript:;" onclick="location.hash='#reviewing-migrations'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>The output of each Migration is logged to the Console (or configured Logger), logging useful information on Migrations found and run as well as the executed SQL run in each migration. This information is also captured in the <strong>Migration</strong> table on the database they were run on, where they can be easily viewed in your App's <a href="/admin-ui-database">Database Admin UI</a>, e.g:</p>
<p><a href="/admin-ui-database"><img src="/img/pages/ormlite/migration-database-admin.png" alt="" /></a></p>
<div class="tip custom-block">
            <p class="custom-block-title">TIP</p><p>In addition to capturing executed SQL in the <code>Log</code> column, failed Migrations capture error information in the <code>ErrorCode</code>, <code>ErrorMessage</code> and <code>ErrorStackTrace</code> columns</p>
</div>
<h2 id="feedback-welcome">Feedback Welcome<a class="header-anchor" href="javascript:;" onclick="location.hash='#feedback-welcome'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>We hope you'll find this first version of DB Migrations useful, please let us know what other features you would like in <a href="https://github.com/ServiceStack/Discuss/discussions">ServiceStack/Discuss</a>.</p>
</div>

                <div class="not-prose"></div>
                
                    <div class="not-prose py-8">
                        <a class="text-slate-500 font-semibold hover:text-indigo-600 flex items-center" href="https://github.com/ServiceStack/docs.servicestack.net/blob/main/MyApp/_pages/ormlite/db-migrations.md" target="_blank" rel="noopener noreferrer">
                            Edit this page on GitHub<svg class="ml-1 inline-block w-4 h-4" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" data-v-1ed99556=""><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>
                        </a>
                    </div>

                    <div class="not-prose my-20">
                                <nav class="flex items-center justify-between border-t border-gray-200 dark:border-gray-700 px-4 sm:px-0">
                                    <div class="-mt-px flex w-0 flex-1">
                                            <a href="/ormlite/async-apis" class="inline-flex items-center border-t-2 border-transparent pt-4 pr-1 text-sm font-medium text-gray-500 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-200">
                                                <!-- Heroicon name: mini/arrow-long-left -->
                                                <svg class="mr-3 h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                    <path fill-rule="evenodd" d="M18 10a.75.75 0 01-.75.75H4.66l2.1 1.95a.75.75 0 11-1.02 1.1l-3.5-3.25a.75.75 0 010-1.1l3.5-3.25a.75.75 0 111.02 1.1l-2.1 1.95h12.59A.75.75 0 0118 10z" clip-rule="evenodd"></path>
                                                </svg>
                                                Async APIs
                                            </a>
                                    </div>
                                    <div class="hidden md:-mt-px md:flex"></div>
                                    <div class="-mt-px flex w-0 flex-1 justify-end">
                                            <a href="/ormlite/litestream" class="inline-flex items-center border-t-2 border-transparent pt-4 pl-1 text-sm font-medium text-gray-500 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-200">
                                                Litestream
                                                <!-- Heroicon name: mini/arrow-long-right -->
                                                <svg class="ml-3 h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                    <path fill-rule="evenodd" d="M2 10a.75.75 0 01.75-.75h12.59l-2.1-1.95a.75.75 0 111.02-1.1l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25a.75.75 0 11-1.02-1.1l2.1-1.95H2.75A.75.75 0 012 10z" clip-rule="evenodd"></path>
                                                </svg>
                                            </a>
                                    </div>
                                </nav>
                    </div>
            </div>
                
                <div class="docmap hidden 2xl:block flex-none w-64 pl-8 mr-8">
                    <div class="fixed bg-white dark:bg-black flex flex-col overflow-y-auto pt-10 px-8 pb-6" style="height:calc(100vh - 50px);">
                        <div>
                            <h5 class="text-slate-900 font-semibold mb-4 text-sm leading-6 dark:text-slate-100">
                                On This Page
                            </h5>
                            <ul class="text-slate-700 text-sm leading-6">
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#introduction'" data-id="introduction" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Introduction
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#getting-started'" data-id="getting-started" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Getting Started
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="class-names-used-to-determine-order-of-migrations" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#class-names-used-to-determine-order-of-migrations'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Class names used to determine order of Migrations
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#basic-example'" data-id="basic-example" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Basic Example
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#declarative-code-first-migrations'" data-id="declarative-code-first-migrations" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Declarative Code-First Migrations
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="code-first-approach" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#code-first-approach'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Code-First approach
                                                        </span>
                                                    </li>
                                                    <li data-id="complex-example" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#complex-example'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Complex Example
                                                        </span>
                                                    </li>
                                                    <li data-id="reverting-migrations" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#reverting-migrations'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Reverting Migrations
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#running-migrations'" data-id="running-migrations" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Running Migrations
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="run-or-debug-migrations-from-your-ide" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#run-or-debug-migrations-from-your-ide'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Run or Debug Migrations from your IDE
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#running-migrations-from-command-line'" data-id="running-migrations-from-command-line" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Running migrations from command-line
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="configuring-existing-projects" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#configuring-existing-projects'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Configuring existing Projects
                                                        </span>
                                                    </li>
                                                    <li data-id="dotnet-migration-tasks" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#dotnet-migration-tasks'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            dotnet Migration Tasks
                                                        </span>
                                                    </li>
                                                    <li data-id="npm-migration-scripts" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#npm-migration-scripts'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            npm Migration Scripts
                                                        </span>
                                                    </li>
                                                    <li data-id="asp.net-core-projects" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#asp.net-core-projects'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            ASP .NET Core Projects
                                                        </span>
                                                    </li>
                                                    <li data-id="new-rdbms-projects-configured-with-db-migrations-by-default" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#new-rdbms-projects-configured-with-db-migrations-by-default'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            New RDBMS Projects configured with DB Migrations by default
                                                        </span>
                                                    </li>
                                                    <li data-id="run-ormlite-and-entity-framework-migrations-together" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#run-ormlite-and-entity-framework-migrations-together'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Run OrmLite and Entity Framework Migrations together
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#running-migrations-from-github-actions'" data-id="running-migrations-from-github-actions" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Running migrations from GitHub Actions
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="failed-migration-behavior" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#failed-migration-behavior'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Failed migration behavior
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#running-migrations-from-unit-tests'" data-id="running-migrations-from-unit-tests" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Running migrations from unit tests
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#running-migrations-individually'" data-id="running-migrations-individually" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Running Migrations individually
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="clearing-migration-state" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#clearing-migration-state'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Clearing Migration State
                                                        </span>
                                                    </li>
                                                    <li data-id="running-migrations-on-named-connections" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#running-migrations-on-named-connections'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Running Migrations on Named Connections
                                                        </span>
                                                    </li>
                                                    <li data-id="multiple-named-connections" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#multiple-named-connections'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Multiple Named Connections
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#reviewing-migrations'" data-id="reviewing-migrations" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Reviewing Migrations
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#feedback-welcome'" data-id="feedback-welcome" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Feedback Welcome
                                        </span>
                                    </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
        </div>
    </div>    
</div>

<script>
//doc instructions
if (document.querySelector('.hide-title')) {
    const el = document.querySelector('#doc section h1') 
    if (el) el.style.display='none'
}
</script>

<script type="module">
import { ref } from "vue"
import { mount } from "app.mjs"


    const App = {
        setup() {
            function nav(url) {
                window.open(url)
            }
            return { nav }
        }
    }
    
const Sidebar = {
    setup() {
        const open = ref(true)
        return { open }
    }
}

mount('#doc', App)
mount('#sidebar', Sidebar)
</script>

<script src="/lib/js/highlight.js"></script>
<script>hljs.highlightAll()</script>
<script src="/lib/js/lite-yt-embed.js"></script>
<script src="/mjs/docs.mjs" type="module"></script>


    </main>
</div>

<script type="module">
import { init } from "app.mjs"
init()
</script>





</body>
</html>