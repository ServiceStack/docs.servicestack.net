<!doctype html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-7722718-13"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'UA-7722718-13');</script>
    
    <meta charset="utf-8"/>
    <meta name='date' content='2024-10-09T05:16:04.1802288Z'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/svg" href="/img/logo.svg">
    <title>AutoQuery Service Data Source</title>
    <script>
    if (location.search === "?dark") localStorage.setItem('color-scheme','dark') 
    if (location.search === "?light") localStorage.removeItem('color-scheme') 
    const cls = document.querySelector('html').classList
    if (localStorage.getItem('color-scheme') === 'dark')
        cls.add('dark')
    else
        cls.remove('dark')
    </script>
    <link rel="stylesheet" href="/css/app.css">
    

    <script async src="https://ga.jspm.io/npm:es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
{
    "imports": {
        "app.mjs": "/mjs/app.mjs",
        "vue": "/lib/mjs/vue.min.mjs",
        "@servicestack/client": "/lib/mjs/servicestack-client.min.mjs",
        "@servicestack/vue": "/lib/mjs/servicestack-vue.min.mjs"
    }
}
</script>
</head>
<body class="bg-white dark:bg-black dark:text-white">

<header id="header" class="top-0 fixed z-50 h-14 bg-white dark:bg-black opacity-90 w-full shadow">
  <nav class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-black">
    <div class="mx-auto max-w-[100rem] pr-4 sm:pr-6 lg:pr-8">
      <div class="flex h-16 justify-between">
        <div class="flex">
          <div class="flex flex-shrink-0 items-center">
            <a class="mr-2 lg:mr-8 flex items-center" href="/">
                <svg class="w-8 h-8 sm:ml-2 sm:w-12 sm:h-12" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="currentColor" d="M10 6c1.544 1.76 2.276 4.15 2.217 6.61c3.968 1.67 9.924 6.12 11.181 12.39H28C26.051 14.31 14.918 6.77 10 6zm-2 7c4.67 4.913.81 11.582-4 12h18.97C21.5 18.289 11.95 13.533 8 13z"/></svg>
                <span class="hidden sm:block text-2xl font-semibold">Documentation</span>
            </a>
          </div>
            <div class="hidden sm:-my-px sm:ml-6 sm:flex sm:space-x-4 lg:space-x-8">
                <!-- Current: "border-indigo-500 text-gray-900", Default: "border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" -->
                        <a href="/templates/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            <span class="hidden xl:inline mr-1">Project</span> Templates
                        </a>
                        <a href="/vue/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Vue
                        </a>
                        <a href="/autoquery/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-indigo-500 text-gray-900">
                            AutoQuery
                        </a>
                        <a href="/auth/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Auth
                        </a>
                        <a href="/ormlite/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            OrmLite
                        </a>
                        <a href="/redis/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Redis
                        </a>
                        <a href="/locode/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200 hidden lg:inline-flex">
                            Locode
                        </a>
                        <a href="/grpc/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200 hidden lg:inline-flex">
                            gRPC
                        </a>
            </div>
        </div>
        <div class="hidden sm:ml-6 sm:flex sm:items-center">
            <typesense></typesense>
            <dark-mode-toggle class="ml-2 w-10"></dark-mode-toggle>
        </div>
        <div class="-mr-2 flex items-center sm:hidden">
          <!-- Mobile menu button -->
          <button type="button" v-on:click="open=!open" class="inline-flex items-center justify-center rounded-md bg-white dark:bg-black p-2 text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:ring-offset-black" aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <!-- Menu open: "hidden", Menu closed: "block" -->
            <svg :class="['h-6 w-6', open ? 'hidden' : 'block']" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
            <!-- Menu open: "block", Menu closed: "hidden" -->
            <svg :class="['h-6 w-6', open ? 'block' : 'hidden']" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu, show/hide based on menu state. -->
    <div v-cloak v-if="open" class="sm:hidden">
        <div class="space-y-1 pb-3 pt-2">
            <!-- Current: "border-indigo-500 bg-indigo-50 text-indigo-700", Default: "border-transparent text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800" -->
                    <a href="/templates/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Project Templates
                    </a>
                    <a href="/vue/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Vue
                    </a>
                    <a href="/autoquery/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-indigo-500 bg-indigo-50 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-200">
                        AutoQuery
                    </a>
                    <a href="/auth/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Auth
                    </a>
                    <a href="/ormlite/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        OrmLite
                    </a>
                    <a href="/redis/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Redis
                    </a>
                    <a href="/locode/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Locode
                    </a>
                    <a href="/grpc/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        gRPC
                    </a>
        </div>
    </div>
  </nav>
</header>

<script type="module">
import { ref } from "vue"
import { mount } from "app.mjs"

const Header = {
    setup() {
        const open = ref(false)
        return { open }
    }
}
mount('#header', Header)
</script>


<div class="min-h-screen">
    <main role="main" class="pt-16 pb-3 max-w-[100rem] mx-auto">
        



<style>
.active {
    color: #0ea5e9 !important;
}
</style>
<link rel="stylesheet" href="/css/highlight.css">
<link rel="stylesheet" href="/css/typography.css">
<link rel="stylesheet" href="/css/lite-yt-embed.css">

<div class="w-full max-w-[100rem] mx-auto">
    <div class="flex flex-wrap">
        <div id="sidebar" class="z-40 inset-0 flex-none bg-white dark:bg-black lg:w-64 xl:w-80">
            <button v-cloak v-on:click="open=true" :class="['text-gray-400 hover:text-gray-500 pt-4 pl-2 absolute transform transition-all duration-200', open ? 'opacity-0 translate-x-56' : 'opacity-100']" title="Open Sidebar">
                <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H10m10 0l-4 4m4-4l-4-4M4 4v16"/></svg>
            </button>
            <div :class="['fixed bg-white dark:bg-black h-screen overflow-y-auto scrolling-touch overflow-hidden shadow lg:shadow-none transform transition-transform duration-200', open ? '' : 'translate-x-[-100%]']">
                <nav class="sidebar lg:w-64 xl:w-80 px-1 pt-6 pb-16 overflow-y-auto font-medium text-sm lg:text-base sm:px-3 xl:px-5" aria-label="Sidebar">
                    <close-button title="Close Sidebar" class="lg:hidden -mr-2" v-on:close="open=false"></close-button>
                                <a href="/autoquery/" class="block flex items-center whitespace-nowrap">
<svg class='h-6 w-6 shrink-0 text-sky-500' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor' aria-hidden='true'><path stroke-linecap='round' stroke-linejoin='round' d='M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25'></path></svg>                                    <span class="p-2 pl-3 font-display font-medium text-slate-900 dark:text-white">
AutoQuery                                    </span>
                                </a>
                        <ul role="list" class="mb-6 mt-2 ml-3 space-y-2 border-l-2 border-slate-100 dark:border-slate-800 lg:mt-4 lg:space-y-4 lg:border-slate-200">
                                <li class="relative">
                                    <a href="/autoquery/rdbms" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoQuery RDBMS
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/data" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoQuery Data
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/memory" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoQuery Data Memory
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/service" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full active font-semibold text-sky-500 before:bg-sky-500">
                                        AutoQuery Data Service
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/dynamodb" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoQuery Data DynamoDB
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/crud" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoQuery CRUD
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/audit-log" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoQuery Audit Log
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/autogen" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoGen
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/bookings-crud" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        AutoQuery CRUD Bookings Demo
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/autoquery/why-not-odata" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Why Not OData
                                    </a>
                                </li>
                        </ul>
                </nav>
            </div>
        </div>
        <div id="doc" class="mx-auto flex">
            <div class="mt-8 mx-auto prose lg:prose-lg">
                
                    <section class="not-prose mb-16 md:mb-12">
                        <h1 class="text-4xl tracking-tight font-extrabold text-gray-900 dark:text-gray-50 sm:text-5xl md:text-6xl">
                            AutoQuery Service Data Source
                        </h1>
                    </section>

                <div class="not-prose"></div>

                <div class="content"><p>The next step after <a href="/autoquery/memory">MemorySource</a> in querying for even richer result-sets, whether you want to add custom validation, access multiple dependencies, construct complex queries or other custom business logic, you can use a <strong>Service Source</strong> instead which lets you call a Service and use its Response as the dynamic Data Source that you can apply Auto Querying logic on.</p>
<p><code>ServiceSource</code> is very similar to <code>MemorySource</code> however instead of passing in the in-memory collection
you want to query directly, you'll need to pass a <strong>Request DTO</strong> of the Service you want called instead.
The response of the Service is then further queried just as if its results were passed into a MemorySource
directly.</p>
<p>We'll illustrate with a few examples how to register and use ServiceSources, explore some of their capabilities
and provide some examples of when you may want to use them below.</p>
<h2 id="register-data-sources">Register Data Sources<a class="header-anchor" href="javascript:;" onclick="location.hash='#register-data-sources'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>The <code>UserLogin</code> ServiceSource shows you can just pass an empty Request DTO as-is to execute its Service.
The <code>RockstarAlbum</code> and <code>GithubRepo</code> Service Sources are however leveraging the built-in
<a href="/auto-mapping">Auto Mapping</a> to copy any matching
properties from the AutoQuery Request DTO to the downstream <code>GetRockstarAlbums</code> and <code>GetGithubRepos</code>
Request DTO's. Finally the responses for the <code>GithubRepo</code> Service is <strong>cached for 5 minutes</strong> so any
subsequent matching requests end up querying the cached result set instead of re-executing the <code>GetGithubRepos</code>
Service:</p>
<pre><code class="language-csharp">Plugins.Add(new AutoQueryDataFeature { MaxLimit = 100 }
    .AddDataSource(ctx =&gt; ctx.ServiceSource&lt;UserLogin&gt;(new GetTodaysUserActivity())),
    .AddDataSource(ctx =&gt; ctx.ServiceSource&lt;RockstarAlbum&gt;(ctx.Dto.ConvertTo&lt;GetRockstarAlbums&gt;())),
    .AddDataSource(ctx =&gt; ctx.ServiceSource&lt;GithubRepo&gt;(ctx.Dto.ConvertTo&lt;GetGithubRepos&gt;(), 
        HostContext.Cache, TimeSpan.FromMinutes(5)));
);
</code></pre>
<p>The implementation of <code>GetTodaysUserActivity</code> Service uses an async OrmLite RDBMS call to get all User Logins
within the last day, fetches the Live Activity data from Redis, then
<a href="/ormlite/reference-support#merge-disconnected-poco-result-sets">merges the disconnected POCO result sets</a>
into the <code>UserLogin</code> POCO which it returns:</p>
<pre><code class="language-csharp">[Route(&quot;/useractivity/today&quot;)]
public class QueryTodaysUserActivity : QueryData&lt;UserLogin&gt; {}

public async Task&lt;List&lt;UserLogin&gt;&gt; Any(GetTodaysUserActivity request)
{
    var logins = await Db.SelectAsync&lt;UserLogin&gt;(x =&gt; x.LastLogin &gt;= DateTime.UtcNow.AddDays(-1));
    var activities = Redis.As&lt;Activity&gt;().GetAll();
    logins.Merge(activities);
    return logins;
}
</code></pre>
<h2 id="getrockstaralbums">GetRockstarAlbums<a class="header-anchor" href="javascript:;" onclick="location.hash='#getrockstaralbums'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>The <code>GetRockstarAlbums</code> Service shows an example of a calling an existing ad hoc DB Service executing an
arbitrary custom Query. It uses the Request DTO Auto-Mapping at the <code>ServiceSource</code> registration to
first copy any matching properties from the initial <code>QueryRockstarAlbums</code> Request DTO to populate a new
<code>GetRockstarAlbums</code> instance which is what's used to execute the Service with.</p>
<p>In this way the <code>QueryRockstarAlbums</code> AutoQuery Service is essentially decorating the underlying
<code>GetRockstarAlbums</code> Service giving it access to AutoQuery features where clients are able to apply
further post-querying server logic to an existing Service implementation which now lets them filter,
sort, select only a partial list of fields, include additional aggregate queries, etc.</p>
<pre><code class="language-csharp">public class QueryRockstarAlbums : QueryData&lt;RockstarAlbum&gt; 
{
    public string Name { get; set; }
    public int[] IdBetween { get; set; }
}

public object Any(GetRockstarAlbums request)
{
    var q = Db.From&lt;RockstarAlbum&gt;();

    if (request.IdBetween != null)
        q.Where(x =&gt; x.Id &gt;= request.IdBetween[0] &amp;&amp; x.Id &lt;= request.IdBetween[1]);

    if (request.Name != null)
        q.Where(x =&gt; x.Name == request.Name);

    return new GetRockstarAlbumsResponse { Results = Db.Select(q) };
}
</code></pre>
<p>One thing to notice is that ServiceSource still works whether the results are wrapped in a Response DTO
instead of a naked <code>IEnumerable&lt;RockstarAlbum&gt;</code> collection. This is transparently supported as <code>ServiceSource</code>
will use the first matching <code>IEnumerable&lt;T&gt;</code> property for Services that don't return a collection.</p>
<p>It should be noted that decorating an existing OrmLite Service is rarely necessary as in most cases you'll
be able to get by with just a simple AutoQuery RDBMS query as seen in the Service below which replaces
the above 2 Services:</p>
<pre><code class="language-csharp">public class QueryRockstarAlbums : QueryDb&lt;RockstarAlbum&gt; {}
</code></pre>
<h2 id="getgithubrepos">GetGithubRepos<a class="header-anchor" href="javascript:;" onclick="location.hash='#getgithubrepos'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>The final <code>GetGithubRepos</code> ServiceSource example shows an example of a slightly more complex implementation
than a single 3rd Party API call where it adds custom validation logic and call different 3rd Party API
Endpoints depending on user input:</p>
<pre><code class="language-csharp">public class QueryGithubRepo : QueryData&lt;GithubRepo&gt; 
{
    public string User { get; set; }
    public string Organization { get; set; }
}

public object Get(GetGithubRepos request)
{
    if (request.User == null &amp;&amp; request.Organization == null)
        throw new ArgumentNullException(&quot;User&quot;);

    var url = request.User != null
        ? $&quot;https://api.github.com/users/{request.User}/repos&quot;
        : $&quot;https://api.github.com/orgs/{request.Organization}/repos&quot;;

    return url.GetJsonFromUrl(requestFilter:req =&gt; req.UserAgent = GetType().Name)
        .FromJson&lt;List&lt;GithubRepo&gt;&gt;();
}
</code></pre>
<p>A hidden feature ServiceSources are naturally able to take advantage of due to its behind-the-scenes usage
of the new <a href="/service-gateway">Service Gateway</a> is that the exact code above could still function if the
<code>QueryGithubRepo</code> AutoQuery Data Service and underlying <code>GetGithubRepos</code> Service were moved to different
hosts :)</p>
<h2 id="custom-autoquery-data-implementation">Custom AutoQuery Data Implementation<a class="header-anchor" href="javascript:;" onclick="location.hash='#custom-autoquery-data-implementation'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Just like you can
<a href="/autoquery#custom-autoquery-implementations">Create a Custom implementation</a>
in AutoQuery, you can do the same in AutoQuery Data by just defining an implementation for your AutoQuery
Data Request DTO. But instead of <code>IAutoQueryDb</code> you'd reference the <code>IAutoQueryData</code> dependency to construct
and execute your custom AutoQuery Data query.</p>
<p>When overriding the default implementation of an AutoQuery Data Service you also no longer need to register
a Data Source as you can specify the Data Source in-line when calling <code>AutoQuery.CreateQuery()</code>.</p>
<p>For our custom AutoQuery Data implementation we'll look at creating a useful Service which reads the
daily CSV Request and Error Logs from the new <a href="/request-logger#csv-request-logger">CsvRequestLogger</a> and queries it by
wrapping the POCO <code>RequestLogEntry</code> results into a <code>MemoryDataSource</code>:</p>
<pre><code class="language-csharp">[Route(&quot;/query/requestlogs&quot;)]
[Route(&quot;/query/requestlogs/{Date}&quot;)]
public class QueryRequestLogs : QueryData&lt;RequestLogEntry&gt;
{
    public DateTime? Date { get; set; }
    public bool ViewErrors { get; set; }
}

public class CustomAutoQueryDataServices : Service
{
    public IAutoQueryData AutoQuery { get; set; }

    public object Any(QueryRequestLogs query)
    {
        var date = query.Date.GetValueOrDefault(DateTime.UtcNow);
        var logSuffix = query.ViewErrors ? &quot;-errors&quot; : &quot;&quot;;
        var csvLogsFile = VirtualFileSources.GetFile(
            &quot;requestlogs/{0}-{1}/{0}-{1}-{2}{3}.csv&quot;.Fmt(
                date.Year.ToString(&quot;0000&quot;),
                date.Month.ToString(&quot;00&quot;),
                date.Day.ToString(&quot;00&quot;),
                logSuffix));

        if (csvLogsFile == null)
            throw HttpError.NotFound(&quot;No logs found on &quot; + date.ToShortDateString());

        var logs = csvLogsFile.ReadAllText().FromCsv&lt;List&lt;RequestLogEntry&gt;&gt;();

        var db = new MemoryDataSource&lt;RequestLogEntry&gt;(logs, query, Request);
        var q = AutoQuery.CreateQuery(query, Request, db);
        return AutoQuery.Execute(query, q, db);
    }
}
</code></pre>
<p>This Service now lets you query the Request Logs of any given day, letting you filter, page and sort
through the Request Logs of the day. While we're at it, let's also create multiple Custom AutoQuery
Data implementations to act as canonical smart links for the above Service:</p>
<pre><code class="language-csharp">[Route(&quot;/logs/today&quot;)]
public class TodayLogs : QueryData&lt;RequestLogEntry&gt; { }
[Route(&quot;/logs/today/errors&quot;)]
public class TodayErrorLogs : QueryData&lt;RequestLogEntry&gt; { }

[Route(&quot;/logs/yesterday&quot;)]
public class YesterdayLogs : QueryData&lt;RequestLogEntry&gt; { }
[Route(&quot;/logs/yesterday/errors&quot;)]
public class YesterdayErrorLogs : QueryData&lt;RequestLogEntry&gt; { }
</code></pre>
<p>The implementations of which just delegates to <code>QueryRequestLogs</code> with the selected Date and whether or
not to show just the error logs:</p>
<pre><code class="language-csharp">public object Any(TodayLogs request) =&gt;
    Any(new QueryRequestLogs { Date = DateTime.UtcNow });

public object Any(TodayErrorLogs request) =&gt;
    Any(new QueryRequestLogs { Date = DateTime.UtcNow, ViewErrors = true });

public object Any(YesterdayLogs request) =&gt;
    Any(new QueryRequestLogs { Date = DateTime.UtcNow.AddDays(-1) });

public object Any(YesterdayErrorLogs request) =&gt;
    Any(new QueryRequestLogs { Date = DateTime.UtcNow.AddDays(-1), ViewErrors = true });
</code></pre>
<h2 id="view-request-logs-in-autoquery-viewer">View Request Logs in <a href="https://github.com/ServiceStack/Admin">AutoQuery Viewer</a><a class="header-anchor" href="javascript:;" onclick="location.hash='#view-request-logs-in-autoquery-viewer'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>And with no more effort we can jump back to <code>/ss_admin/</code> and use <a href="https://github.com/ServiceStack/Admin">AutoQuery Viewer's</a> nice UI to quickly
inspect Todays and Yesterdays Request and Error Logs :)</p>
<p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/autoqueryviewer-csv-logs.png" alt="" /></p>
</div>

                <div class="not-prose"></div>
                
                    <div class="not-prose py-8">
                        <a class="text-slate-500 font-semibold hover:text-indigo-600 flex items-center" href="https://github.com/ServiceStack/docs.servicestack.net/blob/main/MyApp/_pages/autoquery/service.md" target="_blank" rel="noopener noreferrer">
                            Edit this page on GitHub<svg class="ml-1 inline-block w-4 h-4" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" data-v-1ed99556=""><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>
                        </a>
                    </div>

                    <div class="not-prose my-20">
                                <nav class="flex items-center justify-between border-t border-gray-200 dark:border-gray-700 px-4 sm:px-0">
                                    <div class="-mt-px flex w-0 flex-1">
                                            <a href="/autoquery/memory" class="inline-flex items-center border-t-2 border-transparent pt-4 pr-1 text-sm font-medium text-gray-500 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-200">
                                                <!-- Heroicon name: mini/arrow-long-left -->
                                                <svg class="mr-3 h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                    <path fill-rule="evenodd" d="M18 10a.75.75 0 01-.75.75H4.66l2.1 1.95a.75.75 0 11-1.02 1.1l-3.5-3.25a.75.75 0 010-1.1l3.5-3.25a.75.75 0 111.02 1.1l-2.1 1.95h12.59A.75.75 0 0118 10z" clip-rule="evenodd"></path>
                                                </svg>
                                                AutoQuery Data Memory
                                            </a>
                                    </div>
                                    <div class="hidden md:-mt-px md:flex"></div>
                                    <div class="-mt-px flex w-0 flex-1 justify-end">
                                            <a href="/autoquery/dynamodb" class="inline-flex items-center border-t-2 border-transparent pt-4 pl-1 text-sm font-medium text-gray-500 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-200">
                                                AutoQuery Data DynamoDB
                                                <!-- Heroicon name: mini/arrow-long-right -->
                                                <svg class="ml-3 h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                    <path fill-rule="evenodd" d="M2 10a.75.75 0 01.75-.75h12.59l-2.1-1.95a.75.75 0 111.02-1.1l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25a.75.75 0 11-1.02-1.1l2.1-1.95H2.75A.75.75 0 012 10z" clip-rule="evenodd"></path>
                                                </svg>
                                            </a>
                                    </div>
                                </nav>
                    </div>
            </div>
                
                <div class="docmap hidden 2xl:block flex-none w-64 pl-8 mr-8">
                    <div class="fixed bg-white dark:bg-black flex flex-col overflow-y-auto pt-10 px-8 pb-6" style="height:calc(100vh - 50px);">
                        <div>
                            <h5 class="text-slate-900 font-semibold mb-4 text-sm leading-6 dark:text-slate-100">
                                On This Page
                            </h5>
                            <ul class="text-slate-700 text-sm leading-6">
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#register-data-sources'" data-id="register-data-sources" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Register Data Sources
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#getrockstaralbums'" data-id="getrockstaralbums" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            GetRockstarAlbums
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#getgithubrepos'" data-id="getgithubrepos" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            GetGithubRepos
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#custom-autoquery-data-implementation'" data-id="custom-autoquery-data-implementation" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Custom AutoQuery Data Implementation
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#view-request-logs-in-autoquery-viewer'" data-id="view-request-logs-in-autoquery-viewer" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            View Request Logs in 
                                        </span>
                                    </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
        </div>
    </div>    
</div>

<script>
//doc instructions
if (document.querySelector('.hide-title')) {
    const el = document.querySelector('#doc section h1') 
    if (el) el.style.display='none'
}
</script>

<script type="module">
import { ref } from "vue"
import { mount } from "app.mjs"


    const App = {
        setup() {
            function nav(url) {
                window.open(url)
            }
            return { nav }
        }
    }
    
const Sidebar = {
    setup() {
        const open = ref(true)
        return { open }
    }
}

mount('#doc', App)
mount('#sidebar', Sidebar)
</script>

<script src="/lib/js/highlight.js"></script>
<script>hljs.highlightAll()</script>
<script src="/lib/js/lite-yt-embed.js"></script>
<script src="/mjs/docs.mjs" type="module"></script>


    </main>
</div>

<script type="module">
import { init } from "app.mjs"
init()
</script>





</body>
</html>