<!doctype html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-7722718-13"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'UA-7722718-13');</script>
    
    <meta charset="utf-8"/>
    <meta name='date' content='2023-08-03T05:10:52.3296005Z'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/svg" href="/img/logo.svg">
    <title>Encrypted Messaging</title>
    <script>
    if (location.search === "?dark") localStorage.setItem('color-scheme','dark') 
    if (location.search === "?light") localStorage.removeItem('color-scheme') 
    const cls = document.querySelector('html').classList
    if (localStorage.getItem('color-scheme') === 'dark')
        cls.add('dark')
    else
        cls.remove('dark')
    </script>
    <link rel="stylesheet" href="/css/app.css">
    

    <script async src="https://ga.jspm.io/npm:es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
{
    "imports": {
        "app.mjs": "/mjs/app.mjs",
        "vue": "/lib/mjs/vue.min.mjs",
        "@servicestack/client": "/lib/mjs/servicestack-client.min.mjs",
        "@servicestack/vue": "/lib/mjs/servicestack-vue.min.mjs"
    }
}
</script>
</head>
<body class="bg-white dark:bg-black dark:text-white">

<header id="header" class="top-0 fixed z-50 h-14 bg-white dark:bg-black opacity-90 w-full shadow">
  <nav class="border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-black">
    <div class="mx-auto max-w-[100rem] pr-4 sm:pr-6 lg:pr-8">
      <div class="flex h-16 justify-between">
        <div class="flex">
          <div class="flex flex-shrink-0 items-center">
            <a class="mr-2 lg:mr-8 flex items-center" href="/">
                <svg class="w-8 h-8 sm:ml-2 sm:w-12 sm:h-12" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="currentColor" d="M10 6c1.544 1.76 2.276 4.15 2.217 6.61c3.968 1.67 9.924 6.12 11.181 12.39H28C26.051 14.31 14.918 6.77 10 6zm-2 7c4.67 4.913.81 11.582-4 12h18.97C21.5 18.289 11.95 13.533 8 13z"/></svg>
                <span class="hidden sm:block text-2xl font-semibold">Documentation</span>
            </a>
          </div>
            <div class="hidden sm:-my-px sm:ml-6 sm:flex sm:space-x-4 lg:space-x-8">
                <!-- Current: "border-indigo-500 text-gray-900", Default: "border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" -->
                        <a href="/templates/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            <span class="hidden xl:inline mr-1">Project</span> Templates
                        </a>
                        <a href="/vue/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Vue
                        </a>
                        <a href="/autoquery/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            AutoQuery
                        </a>
                        <a href="/auth/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-indigo-500 text-gray-900">
                            Security
                        </a>
                        <a href="/ormlite/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            OrmLite
                        </a>
                        <a href="/redis/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200">
                            Redis
                        </a>
                        <a href="/locode/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200 hidden lg:inline-flex">
                            Locode
                        </a>
                        <a href="/grpc/" class="inline-flex items-center border-b-2 px-1 pt-1 text-sm font-medium border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 dark:hover:text-gray-200 hidden lg:inline-flex">
                            gRPC
                        </a>
            </div>
        </div>
        <div class="hidden sm:ml-6 sm:flex sm:items-center">
            <typesense></typesense>
            <dark-mode-toggle class="ml-2 w-10"></dark-mode-toggle>
        </div>
        <div class="-mr-2 flex items-center sm:hidden">
          <!-- Mobile menu button -->
          <button type="button" v-on:click="open=!open" class="inline-flex items-center justify-center rounded-md bg-white dark:bg-black p-2 text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 dark:ring-offset-black" aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Open main menu</span>
            <!-- Menu open: "hidden", Menu closed: "block" -->
            <svg :class="['h-6 w-6', open ? 'hidden' : 'block']" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
            <!-- Menu open: "block", Menu closed: "hidden" -->
            <svg :class="['h-6 w-6', open ? 'block' : 'hidden']" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu, show/hide based on menu state. -->
    <div v-cloak v-if="open" class="sm:hidden">
        <div class="space-y-1 pb-3 pt-2">
            <!-- Current: "border-indigo-500 bg-indigo-50 text-indigo-700", Default: "border-transparent text-gray-600 hover:border-gray-300 hover:bg-gray-50 hover:text-gray-800" -->
                    <a href="/templates/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Project Templates
                    </a>
                    <a href="/vue/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Vue
                    </a>
                    <a href="/autoquery/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        AutoQuery
                    </a>
                    <a href="/auth/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-indigo-500 bg-indigo-50 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-200">
                        Security
                    </a>
                    <a href="/ormlite/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        OrmLite
                    </a>
                    <a href="/redis/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Redis
                    </a>
                    <a href="/locode/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        Locode
                    </a>
                    <a href="/grpc/" class="block border-l-4 py-2 pl-3 pr-4 text-base font-medium border-transparent text-gray-600 dark:text-gray-300 hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-900 hover:text-gray-800 dark:hover:text-gray-100">
                        gRPC
                    </a>
        </div>
    </div>
  </nav>
</header>

<script type="module">
import { ref } from "vue"
import { mount } from "app.mjs"

const Header = {
    setup() {
        const open = ref(false)
        return { open }
    }
}
mount('#header', Header)
</script>


<div class="min-h-screen">
    <main role="main" class="pt-16 pb-3 max-w-[100rem] mx-auto">
        



<style>
.active {
    color: #0ea5e9 !important;
}
</style>
<link rel="stylesheet" href="/css/highlight.css">
<link rel="stylesheet" href="/css/typography.css">
<link rel="stylesheet" href="/css/lite-yt-embed.css">

<div class="w-full max-w-[100rem] mx-auto">
    <div class="flex flex-wrap">
        <div id="sidebar" class="z-40 inset-0 flex-none bg-white dark:bg-black lg:w-64 xl:w-80">
            <button v-cloak v-on:click="open=true" :class="['text-gray-400 hover:text-gray-500 pt-4 pl-2 absolute transform transition-all duration-200', open ? 'opacity-0 translate-x-56' : 'opacity-100']" title="Open Sidebar">
                <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H10m10 0l-4 4m4-4l-4-4M4 4v16"/></svg>
            </button>
            <div :class="['fixed bg-white dark:bg-black h-screen overflow-y-auto scrolling-touch overflow-hidden shadow lg:shadow-none transform transition-transform duration-200', open ? '' : 'translate-x-[-100%]']">
                <nav class="sidebar lg:w-64 xl:w-80 px-1 pt-6 pb-16 overflow-y-auto font-medium text-sm lg:text-base sm:px-3 xl:px-5" aria-label="Sidebar">
                    <close-button title="Close Sidebar" class="lg:hidden -mr-2" v-on:close="open=false"></close-button>
                                <a href="/auth/" class="block flex items-center whitespace-nowrap">
<svg class='h-6 w-6 shrink-0 text-sky-500' fill='none' viewBox='0 0 24 24' stroke-width='1.5' stroke='currentColor' aria-hidden='true'><path stroke-linecap='round' stroke-linejoin='round' d='M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25'></path></svg>                                    <span class="p-2 pl-3 font-display font-medium text-slate-900 dark:text-white">
Security                                    </span>
                                </a>
                        <ul role="list" class="mb-6 mt-2 ml-3 space-y-2 border-l-2 border-slate-100 dark:border-slate-800 lg:mt-4 lg:space-y-4 lg:border-slate-200">
                                <li class="relative">
                                    <a href="/auth/authentication-and-authorization" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Authentication &amp; Authorization
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/auth-repository" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Auth Repository
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/identity-servicestack" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Using ServiceStack Auth in MVC
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/identity-aspnet" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Using ASP.NET Identity Auth
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/identityserver" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Using IdentityServer4 Auth
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/sessions" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Sessions
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/jwt-authprovider" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        JWT AuthProvider
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/api-key-authprovider" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        API Key AuthProvider
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/signin-with-apple" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Sign in with Apple AuthProvider
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/restricting-services" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Restricting Services
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/encrypted-messaging" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full active font-semibold text-sky-500 before:bg-sky-500">
                                        Encrypted Messaging
                                    </a>
                                </li>
                                <li class="relative">
                                    <a href="/auth/anti-forgery" class="block w-full pl-3.5 before:pointer-events-none before:absolute before:-left-1 before:top-1/2 before:h-1.5 before:w-1.5 before:-translate-y-1/2 before:rounded-full text-slate-500 before:hidden before:bg-slate-300 hover:text-slate-600 hover:before:block dark:text-slate-400 dark:before:bg-slate-700 dark:hover:text-slate-300">
                                        Anti Forgery
                                    </a>
                                </li>
                        </ul>
                </nav>
            </div>
        </div>
        <div id="doc" class="mx-auto flex">
            <div class="mt-8 mx-auto prose lg:prose-lg">
                
                    <section class="not-prose mb-16 md:mb-12">
                        <h1 class="text-4xl tracking-tight font-extrabold text-gray-900 dark:text-gray-50 sm:text-5xl md:text-6xl">
                            Encrypted Messaging
                        </h1>
                    </section>

                <div class="not-prose"></div>

                <div class="content"><p>One of the benefits of adopting a message-based design is being able to easily layer functionality and generically add value to all Services, we've seen this recently with <a href="/auto-batched-requests">Auto Batched Requests</a> which automatically enables each Service to be batched and executed in a single HTTP Request. Similarly the new Encrypted Messaging feature
enables a secure channel for all Services (inc Auto Batched Requests :) offering protection to clients who can now easily send and receive encrypted messages over unsecured HTTP!</p>
<h2 id="encrypted-messaging-overview">Encrypted Messaging Overview<a class="header-anchor" href="javascript:;" onclick="location.hash='#encrypted-messaging-overview'" aria-label="Permalink"> </a></h2>
<p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/encrypted-messaging.png" alt="" /></p>
<h3 id="configuration">Configuration<a class="header-anchor" href="javascript:;" onclick="location.hash='#configuration'" aria-label="Permalink"> </a></h3>
<p>Encrypted Messaging support is enabled by registering the plugin:</p>
<pre><code class="language-csharp">Plugins.Add(new EncryptedMessagesFeature {
    PrivateKeyXml = ServerRsaPrivateKeyXml
});
</code></pre>
<p>Where <code>PrivateKeyXml</code> is the Servers RSA Private Key Serialized as XML.</p>
<h2 id="generate-a-new-private-key">Generate a new Private Key<a class="header-anchor" href="javascript:;" onclick="location.hash='#generate-a-new-private-key'" aria-label="Permalink"> </a></h2>
<p>If you don't have an existing one, a new one can be generated with:</p>
<pre><code class="language-csharp">var rsaKeyPair = RsaUtils.CreatePublicAndPrivateKeyPair();
string ServerRsaPrivateKeyXml = rsaKeyPair.PrivateKey;
</code></pre>
<p>Once generated, it's important the Private Key is kept confidential as anyone with access will be able to decrypt
the encrypted messages! Whilst most <a href="http://stackoverflow.com/a/6018247/85785">obfuscation efforts are ultimately futile</a> the goal should be to contain the private key to your running Web Application, limiting access as much as possible.</p>
<p>Once registered, the EncryptedMessagesFeature enables the 2 Services below:</p>
<ul>
<li><code>GetPublicKey</code> - Returns the Serialized XML of your Public Key (extracted from the configured Private Key)</li>
<li><code>EncryptedMessage</code> - The Request DTO which encapsulates all encrypted Requests (can't be called directly)</li>
</ul>
<h2 id="giving-clients-the-public-key">Giving Clients the Public Key<a class="header-anchor" href="javascript:;" onclick="location.hash='#giving-clients-the-public-key'" aria-label="Permalink"> </a></h2>
<p>To communicate clients need access to the Server's Public Key, it doesn't matter who has accessed the Public Key only that clients use the <strong>real</strong> Servers Public Key. It's therefore not advisable to download the Public Key over unsecure <code>http://</code> where traffic can potentially be intercepted and the key spoofed, subjecting them to a <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">Man-in-the-middle attack</a>.</p>
<p>It's safer instead to download the public key over a trusted <code>https://</code> url where the servers origin is verified by a trusted <a href="https://en.wikipedia.org/wiki/Certificate_authority">CA</a>. Sharing the Public Key over Dropbox, Google Drive, OneDrive or other encrypted channels are also good options.</p>
<p>Since <code>GetPublicKey</code> is just a ServiceStack Service it's easily downloadable using a Service Client:</p>
<pre><code class="language-csharp">var client = new JsonServiceClient(BaseUrl);
string publicKeyXml = client.Get(new GetPublicKey());
</code></pre>
<p>If the registered <code>EncryptedMessagesFeature.PublicKeyPath</code> has been changed from its default <code>/publickey</code>, it can be dowloaded with:</p>
<pre><code class="language-csharp">string publicKeyXml = client.Get&lt;string&gt;(&quot;/my-publickey&quot;); //or with HttpUtils
string publicKeyXml = BaseUrl.CombineWith(&quot;/my-publickey&quot;).GetStringFromUrl();
</code></pre>
<div class="info custom-block">
                <p class="custom-block-title">INFO</p><p>To help with verification the SHA256 Hash of the PublicKey is returned in <code>X-PublicKey-Hash</code> HTTP Header</p>
</div>
<h2 id="encrypted-service-client">Encrypted Service Client<a class="header-anchor" href="javascript:;" onclick="location.hash='#encrypted-service-client'" aria-label="Permalink"> </a></h2>
<p>Once they have the Server's Public Key, clients can use it to get an <code>EncryptedServiceClient</code> via the <code>GetEncryptedClient()</code> extension method on <code>JsonServiceClient</code> or new <code>JsonHttpClient</code>, e.g:</p>
<pre><code class="language-csharp">var client = new JsonServiceClient(BaseUrl);
IEncryptedClient encryptedClient = client.GetEncryptedClient(publicKeyXml);
</code></pre>
<p>Once configured, clients have access to the familiar typed Service Client API's and productive workflow they're used to with the generic Service Clients, sending typed Request DTO's and returning the typed Response DTO's - rendering the underlying encrypted messages a transparent implementation detail:</p>
<pre><code class="language-csharp">HelloResponse response = encryptedClient.Send(new Hello { Name = &quot;World&quot; });
response.Result.Print(); //Hello, World!
</code></pre>
<p>REST Services Example:</p>
<pre><code class="language-csharp">HelloResponse response = encryptedClient.Get(new Hello { Name = &quot;World&quot; });
</code></pre>
<p>Auto-Batched Requests Example:</p>
<pre><code class="language-csharp">var requests = new[] { &quot;Foo&quot;, &quot;Bar&quot;, &quot;Baz&quot; }.Map(x =&gt; 
    new HelloSecure { Name = x });
var responses = encryptedClient.SendAll(requests);
</code></pre>
<p>When using the <code>IEncryptedClient</code>, the entire Request and Response bodies are encrypted including Exceptions which continue to throw a populated <code>WebServiceException</code>:</p>
<pre><code class="language-csharp">try
{
    var response = encryptedClient.Send(new Hello());
}
catch (WebServiceException ex)
{
    ex.ResponseStatus.ErrorCode.Print(); //= ArgumentNullException
    ex.ResponseStatus.Message.Print();   //= Value cannot be null. 
}
</code></pre>
<h3 id="authentication-with-encrypted-messaging">Authentication with Encrypted Messaging<a class="header-anchor" href="javascript:;" onclick="location.hash='#authentication-with-encrypted-messaging'" aria-label="Permalink"> </a></h3>
<p>Many encrypted messaging solutions use Client Certificates which Servers can use to cryptographically verify a client's identity - providing an alternative to HTTP-based Authentication. We've decided against using this as it would've forced an opinionated implementation and increased burden of PKI certificate management and configuration onto Clients and Servers - reducing the applicability and instant utility of this feature.</p>
<p>We can instead leverage the existing Session-based Authentication Model in ServiceStack letting clients continue to use the existing Auth functionality and Auth Providers they're already used to, e.g:</p>
<pre><code class="language-csharp">var authResponse = encryptedClient.Send(new Authenticate {
    provider = CredentialsAuthProvider.Name,
    UserName = &quot;test@gmail.com&quot;,
    Password = &quot;p@55w0rd&quot;,
});
</code></pre>
<p>Encrypted Messages have their cookies stripped so they're no longer visible in the clear which minimizes their exposure to Session hijacking. This does pose the problem of how we can call authenticated Services if the encrypted HTTP Client is no longer sending Session Cookies?</p>
<p>Without the use of clear-text Cookies or HTTP Headers there's no longer an <em>established Authenticated Session</em> for the <code>encryptedClient</code> to use to make subsequent Authenticated requests. What we can do  instead is pass the Session Id in the encrypted body for Request DTO's that implement the new <code>IHasSessionId</code> interface, e.g:</p>
<pre><code class="language-csharp">[Authenticate]
public class HelloAuthenticated : IReturn&lt;HelloAuthenticatedResponse&gt;, 
    IHasSessionId
{
    public string SessionId { get; set; }
    public string Name { get; set; }
}

var response = encryptedClient.Send(new HelloAuthenticated {
    SessionId = authResponse.SessionId,
    Name = &quot;World&quot;
});
</code></pre>
<p>Here we're injecting the returned Authenticated <code>SessionId</code> to access the <code>[Authenticate]</code> protected Request DTO. However remembering to do this for every authenticated request can get tedious, a nicer alternative is just setting it once on the <code>encryptedClient</code> which will then use it to automatically populate any <code>IHasSessionId</code> Request DTO's:</p>
<pre><code class="language-csharp">encryptedClient.SessionId = authResponse.SessionId;

var response = encryptedClient.Send(new HelloAuthenticated {
    Name = &quot;World&quot;
});
</code></pre>
<div class="info custom-block">
                <p class="custom-block-title">INFO</p><p>This feature is now supported in <strong>all Service Clients</strong></p>
</div>
<h3 id="combined-authentication-strategy">Combined Authentication Strategy<a class="header-anchor" href="javascript:;" onclick="location.hash='#combined-authentication-strategy'" aria-label="Permalink"> </a></h3>
<p>Another potential use-case is to only use Encrypted Messaging when sending any sensitive information and the normal Service Client for other requests. In which case we can Authenticate and send the user's password with the <code>encryptedClient</code>:</p>
<pre><code class="language-csharp">var authResponse = encryptedClient.Send(new Authenticate {
    provider = CredentialsAuthProvider.Name,
    UserName = &quot;test@gmail.com&quot;,
    Password = &quot;p@55w0rd&quot;,
});
</code></pre>
<p>But then fallback to using the normal <code>IServiceClient</code> for subsequent requests. But as the <code>encryptedClient</code> doesn't receive cookies we'd need to set it explicitly on the client ourselves with:</p>
<pre><code class="language-csharp">client.SetSessionId(authResponse.SessionId);

//Equivalent to:
client.SetCookie(&quot;ss-id&quot;, authResponse.SessionId);
</code></pre>
<p>After which the ServiceClient &quot;establishes an authenticated session&quot; and can be used to make Authenticated requests, e.g:</p>
<pre><code class="language-csharp">var response = await client.GetAsync(new HelloAuthenticated { Name = &quot;World&quot; });
</code></pre>
<h3 id="bearertoken-in-request-dtos">BearerToken in Request DTOs<a class="header-anchor" href="javascript:;" onclick="location.hash='#bearertoken-in-request-dtos'" aria-label="Permalink"> </a></h3>
<p>Similar to the <code>IHasSessionId</code> interface Request DTOs can also implement <code>IHasBearerToken</code> to send Bearer Tokens as an alternative for sending them in HTTP Headers or Cookies.</p>
<p>This lets you authenticate with Auth Providers like <a href="/auth/api-key-authprovider">API Key</a> and <a href="/auth/jwt-authprovider">JWT</a> in <a href="/auth/encrypted-messaging">Encrypted Messaging</a> requests, e.g:</p>
<pre><code class="language-csharp">public class Secure : IHasBearerToken
{
    public string BearerToken { get; set; }
    public string Name { get; set; }
}

IEncryptedClient encryptedClient = client.GetEncryptedClient(publicKey);
var response = encryptedClient.Get(new Secure { BearerToken = apiKey, Name = &quot;World&quot; });
</code></pre>
<p>Where it will be embedded and encrypted along with all content in the Request DTO so it can be sent securely over an unsecured HTTP Request.</p>
<p>Alternatively you can set the <code>BearerToken</code> property on the <code>IEncryptedClient</code> once where it will automatically populate all Request DTOs
that implement <code>IHasBearerToken</code>, e.g:</p>
<pre><code class="language-csharp">encryptedClient.BearerToken = apiKey;

var response = encryptedClient.Get(new Secure { Name = &quot;World&quot; });
</code></pre>
<h3 id="rsa-and-aes-hybrid-encryption-verified-with-hmac-sha-256">RSA and AES Hybrid Encryption verified with HMAC SHA-256<a class="header-anchor" href="javascript:;" onclick="location.hash='#rsa-and-aes-hybrid-encryption-verified-with-hmac-sha-256'" aria-label="Permalink"> </a></h3>
<p>The Encrypted Messaging Feature follows a <a href="https://en.wikipedia.org/wiki/Hybrid_cryptosystem">Hybrid Cryptosystem</a>
which uses RSA Public Keys for <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">Asymmetric Encryption</a>
combined with the performance of AES <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">Symmetric Encryption</a>
making it suitable for encrypting large message payloads. The authenticity of Encrypted Data are then verified
with HMAC SHA-256, essentially following an <a href="http://crypto.stackexchange.com/a/205/25652">Encrypt-then-MAC strategy</a>.</p>
<p>The key steps in the process are outlined below:</p>
<ol>
<li>Client creates a new <code>IEncryptedClient</code> configured with the Server <strong>Public Key</strong></li>
<li>Client uses the <code>IEncryptedClient</code> to create a EncryptedMessage Request DTO:
<ol>
<li>Generates a new AES 256bit/CBC/PKCS7 Crypt Key <strong>(Kc)</strong>, Auth Key <strong>(Ka)</strong> and <strong>IV</strong></li>
<li>Encrypts Crypt Key <strong>(Kc)</strong>, Auth Key <strong>(Ka)</strong> with Servers Public Key padded with OAEP = <strong>(Kc+Ka+P)e</strong></li>
<li>Authenticates <strong>(Kc+Ka+P)e</strong> with <strong>IV</strong> using HMAC SHA-256 = <strong>IV+(Kc+Ka+P)e+Tag</strong></li>
<li>Serializes Request DTO to JSON packed with current <code>Timestamp</code>, <code>Verb</code> and <code>Operation</code> = <strong>(M)</strong></li>
<li>Encrypts <strong>(M)</strong> with Crypt Key <strong>(Kc)</strong> and <strong>IV</strong> = <strong>(M)e</strong></li>
<li>Authenticates <strong>(M)e</strong> with Auth Key <strong>(Ka)</strong> and <strong>IV</strong> = <strong>IV+(M)e+Tag</strong></li>
<li>Creates <code>EncryptedMessage</code> DTO with Servers <code>KeyId</code>, <strong>IV+(Kc+Ka+P)e+Tag</strong> and <strong>IV+(M)e+Tag</strong></li>
</ol>
</li>
<li>Client uses the <code>IEncryptedClient</code> to send the populated <code>EncryptedMessage</code> to the remote Server</li>
</ol>
<p>On the Server, the <code>EncryptedMessagingFeature</code> Request Converter processes the <code>EncryptedMessage</code> DTO:</p>
<ol>
<li>Uses Private Key identified by <strong>KeyId</strong> or the current Private Key if <strong>KeyId</strong> wasn't provided
<ol>
<li>Request Converter Extracts <strong>IV+(Kc+Ka+P)e+Tag</strong> into <strong>IV</strong> and <strong>(Kc+Ka+P)e+Tag</strong></li>
<li>Decrypts <strong>(Kc+Ka+P)e+Tag</strong> with Private Key into <strong>(Kc)</strong> and <strong>(Ka)</strong></li>
<li>The <strong>IV</strong> is checked against the nonce Cache, verified it's never been used before, then cached</li>
<li>The <strong>IV+(Kc+Ka+P)e+Tag</strong> is verified it hasn't been tampered with using Auth Key <strong>(Ka)</strong></li>
<li>The <strong>IV+(M)e+Tag</strong> is verified it hasn't been tampered with using Auth Key <strong>(Ka)</strong></li>
<li>The <strong>IV+(M)e+Tag</strong> is decrypted using Crypt Key <strong>(Kc)</strong> = <strong>(M)</strong></li>
<li>The <strong>timestamp</strong> is verified it's not older than <code>EncryptedMessagingFeature.MaxRequestAge</code></li>
<li>Any expired nonces are removed. (The <strong>timestamp</strong> and <strong>IV</strong> are used to prevent replay attacks)</li>
<li>The JSON body is deserialized and resulting <strong>Request DTO</strong> returned from the Request Converter</li>
</ol>
</li>
<li>The converted <strong>Request DTO</strong> is executed in ServiceStack's Request Pipeline as normal</li>
<li>The <strong>Response DTO</strong> is picked up by the EncryptedMessagingFeature <strong>Response Converter</strong>:
<ol>
<li>Any <strong>Cookies</strong> set during the Request are removed</li>
<li>The <strong>Response DTO</strong> is serialized with the <strong>AES Key</strong> and returned in an <code>EncryptedMessageResponse</code></li>
</ol>
</li>
<li>The <code>IEncryptedClient</code> decrypts the <code>EncryptedMessageResponse</code> with the <strong>AES Key</strong>
<ol>
<li>The <strong>Response DTO</strong> is extracted and returned to the caller</li>
</ol>
</li>
</ol>
<p>A visual of how this all fits together in captured in the high-level diagram below:</p>
<p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/encrypted-messaging.png" alt="" /></p>
<ul>
<li>Components in <strong>Yellow</strong> show the encapsulated Encrypted Messaging functionality where all encryption and decryption is performed</li>
<li>Components in <strong>Blue</strong> show Unencrypted DTO's</li>
<li>Components in <strong>Green</strong> show Encrypted content:
<ul>
<li>The AES Keys and IV in <strong>Dark Green</strong> is encrypted by the client using the Server's Public Key</li>
<li>The EncryptedRequest in <strong>Light Green</strong> is encrypted with a new AES Key generated by the client on each Request</li>
</ul>
</li>
<li>Components in <strong>Dark Grey</strong> depict existing ServiceStack functionality where Requests are executed as normal through the <a href="/csharp-client">Service Client</a> and <a href="/order-of-operations">Request Pipeline</a></li>
</ul>
<p>All Request and Response DTO's get encrypted and embedded in the <code>EncryptedMessage</code> and <code>EncryptedMessageResponse</code> DTO's below:</p>
<pre><code class="language-csharp">public class EncryptedMessage : IReturn&lt;EncryptedMessageResponse&gt;
{
    public string KeyId { get; set; }
    public string EncryptedSymmetricKey { get; set; }
    public string EncryptedBody { get; set; }
}

public class EncryptedMessageResponse
{
    public string EncryptedBody { get; set; }
}
</code></pre>
<p>The diagram also expands the <code>EncryptedBody</code> Content containing the <strong>EncryptedRequest</strong> consisting of the following parts:</p>
<ul>
<li><strong>Timestamp</strong> - Unix Timestamp of the Request</li>
<li><strong>Verb</strong> - Target HTTP Method</li>
<li><strong>Operation</strong> - Request DTO Name</li>
<li><strong>JSON</strong> - Request DTO serialized as JSON</li>
</ul>
<h3 id="support-for-versioning-private-keys-with-key-rotations">Support for versioning Private Keys with Key Rotations<a class="header-anchor" href="javascript:;" onclick="location.hash='#support-for-versioning-private-keys-with-key-rotations'" aria-label="Permalink"> </a></h3>
<p>One artifact visible in the above process was the use of a <code>KeyId</code>. This is a human readable string used
to identify the Servers Public Key using the first 7 characters of the Public Key Modulus
(visible when viewing the Private Key serialized as XML).
This is automatically sent by <code>IEncryptedClient</code> to tell the <code>EncryptedMessagingFeature</code> which Private Key
should be used to decrypt the AES Crypt and Auth Keys.</p>
<p>By supporting multiple private keys, the Encrypted Messaging feature allows the seamless transition to a
new Private Key without affecting existing clients who have yet to adopt the latest Public Key.</p>
<p>Transitioning to a new Private Key just involves taking the existing Private Key and adding it to the
<code>FallbackPrivateKeys</code> collection whilst introducing a new Private Key, e.g:</p>
<pre><code class="language-csharp">Plugins.Add(new EncryptedMessagesFeature
{
    PrivateKey = NewPrivateKey,
    FallbackPrivateKeys = {
        PreviousKey2015,
        PreviousKey2014,
    },
});
</code></pre>
<h3 id="why-rotate-private-keys">Why Rotate Private Keys?<a class="header-anchor" href="javascript:;" onclick="location.hash='#why-rotate-private-keys'" aria-label="Permalink"> </a></h3>
<p>Since anyone who has a copy of the Private Key can decrypt encrypted messages, rotating the private key clients
use limits the amount of exposure an adversary who has managed to get a hold of a compromised private key has.
i.e. if the current Private Key was somehow compromised, an attacker with access to the encrypted
network packets will be able to read each message sent that was encrypted with the compromised private key
up until the Server introduces a new Private Key which clients switches over to.</p>
<h3 id="source-code">Source Code<a class="header-anchor" href="javascript:;" onclick="location.hash='#source-code'" aria-label="Permalink"> </a></h3>
<ul>
<li>The Client implementation is available in <a href="https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Client/EncryptedServiceClient.cs">EncryptedServiceClient.cs</a></li>
<li>The Server implementation is available in <a href="https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/EncryptedMessagesFeature.cs">EncryptedMessagesFeature.cs</a></li>
<li>The Crypto Utils used are available in the <a href="https://github.com/ServiceStack/ServiceStack/blob/3af2526d2f710576a9764d22501af428e85315cb/src/ServiceStack.Client/CryptUtils.cs#L31">RsaUtils.cs</a> and <a href="https://github.com/ServiceStack/ServiceStack/blob/3af2526d2f710576a9764d22501af428e85315cb/src/ServiceStack.Client/CryptUtils.cs#L198">AesUtils.cs</a></li>
<li>Tests are available in <a href="https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.WebHost.Endpoints.Tests/UseCases/EncryptedMessagesTests.cs">EncryptedMessagesTests.cs</a></li>
</ul>
</div>

                <div class="not-prose"></div>
                
                    <div class="not-prose py-8">
                        <a class="text-slate-500 font-semibold hover:text-indigo-600 flex items-center" href="https://github.com/ServiceStack/docs.servicestack.net/blob/main/MyApp/_pages/auth/encrypted-messaging.md" target="_blank" rel="noopener noreferrer">
                            Edit this page on GitHub<svg class="ml-1 inline-block w-4 h-4" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" data-v-1ed99556=""><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg>
                        </a>
                    </div>

                    <div class="not-prose my-20">
                                <nav class="flex items-center justify-between border-t border-gray-200 dark:border-gray-700 px-4 sm:px-0">
                                    <div class="-mt-px flex w-0 flex-1">
                                            <a href="/auth/restricting-services" class="inline-flex items-center border-t-2 border-transparent pt-4 pr-1 text-sm font-medium text-gray-500 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-200">
                                                <!-- Heroicon name: mini/arrow-long-left -->
                                                <svg class="mr-3 h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                    <path fill-rule="evenodd" d="M18 10a.75.75 0 01-.75.75H4.66l2.1 1.95a.75.75 0 11-1.02 1.1l-3.5-3.25a.75.75 0 010-1.1l3.5-3.25a.75.75 0 111.02 1.1l-2.1 1.95h12.59A.75.75 0 0118 10z" clip-rule="evenodd"></path>
                                                </svg>
                                                Restricting Services
                                            </a>
                                    </div>
                                    <div class="hidden md:-mt-px md:flex"></div>
                                    <div class="-mt-px flex w-0 flex-1 justify-end">
                                            <a href="/auth/anti-forgery" class="inline-flex items-center border-t-2 border-transparent pt-4 pl-1 text-sm font-medium text-gray-500 hover:border-gray-300 dark:hover:border-gray-600 hover:text-gray-700 dark:hover:text-gray-200">
                                                Anti Forgery
                                                <!-- Heroicon name: mini/arrow-long-right -->
                                                <svg class="ml-3 h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                    <path fill-rule="evenodd" d="M2 10a.75.75 0 01.75-.75h12.59l-2.1-1.95a.75.75 0 111.02-1.1l3.5 3.25a.75.75 0 010 1.1l-3.5 3.25a.75.75 0 11-1.02-1.1l2.1-1.95H2.75A.75.75 0 012 10z" clip-rule="evenodd"></path>
                                                </svg>
                                            </a>
                                    </div>
                                </nav>
                    </div>
            </div>
                
                <div class="docmap hidden 2xl:block flex-none w-64 pl-8 mr-8">
                    <div class="fixed bg-white dark:bg-black flex flex-col overflow-y-auto pt-10 px-8 pb-6" style="height:calc(100vh - 50px);">
                        <div>
                            <h5 class="text-slate-900 font-semibold mb-4 text-sm leading-6 dark:text-slate-100">
                                On This Page
                            </h5>
                            <ul class="text-slate-700 text-sm leading-6">
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#encrypted-messaging-overview'" data-id="encrypted-messaging-overview" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Encrypted Messaging Overview
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="configuration" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#configuration'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Configuration
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#generate-a-new-private-key'" data-id="generate-a-new-private-key" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Generate a new Private Key
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#giving-clients-the-public-key'" data-id="giving-clients-the-public-key" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Giving Clients the Public Key
                                        </span>
                                    </li>
                                    <li class="group text-gray-800 hover:text-gray-900">
                                        <span v-hash="'#encrypted-service-client'" data-id="encrypted-service-client" class="cursor-pointer font-medium block text-sm transform transition-colors duration-200 py-2">
                                            Encrypted Service Client
                                        </span>
                                            <ul class="ml-4">
                                                    <li data-id="authentication-with-encrypted-messaging" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#authentication-with-encrypted-messaging'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Authentication with Encrypted Messaging
                                                        </span>
                                                    </li>
                                                    <li data-id="combined-authentication-strategy" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#combined-authentication-strategy'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Combined Authentication Strategy
                                                        </span>
                                                    </li>
                                                    <li data-id="bearertoken-in-request-dtos" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#bearertoken-in-request-dtos'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            BearerToken in Request DTOs
                                                        </span>
                                                    </li>
                                                    <li data-id="rsa-and-aes-hybrid-encryption-verified-with-hmac-sha-256" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#rsa-and-aes-hybrid-encryption-verified-with-hmac-sha-256'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            RSA and AES Hybrid Encryption verified with HMAC SHA-256
                                                        </span>
                                                    </li>
                                                    <li data-id="support-for-versioning-private-keys-with-key-rotations" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#support-for-versioning-private-keys-with-key-rotations'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Support for versioning Private Keys with Key Rotations
                                                        </span>
                                                    </li>
                                                    <li data-id="why-rotate-private-keys" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#why-rotate-private-keys'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Why Rotate Private Keys?
                                                        </span>
                                                    </li>
                                                    <li data-id="source-code" class="text-gray-500 hover:text-gray-900">
                                                        <span v-hash="'#source-code'" class="cursor-pointer flex text-sm transform transition-colors duration-200 py-2">
                                                            <svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>
                                                            Source Code
                                                        </span>
                                                    </li>
                                            </ul>
                                    </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
        </div>
    </div>    
</div>

<script>
//doc instructions
if (document.querySelector('.hide-title')) {
    const el = document.querySelector('#doc section h1') 
    if (el) el.style.display='none'
}
</script>

<script type="module">
import { ref } from "vue"
import { mount } from "app.mjs"


    const App = {
        setup() {
            function nav(url) {
                window.open(url)
            }
            return { nav }
        }
    }
    
const Sidebar = {
    setup() {
        const open = ref(true)
        return { open }
    }
}

mount('#doc', App)
mount('#sidebar', Sidebar)
</script>

<script src="/lib/js/highlight.js"></script>
<script>hljs.highlightAll()</script>
<script src="/lib/js/lite-yt-embed.js"></script>
<script src="/mjs/docs.mjs" type="module"></script>


    </main>
</div>

<script type="module">
import { init } from "app.mjs"
init()
</script>





</body>
</html>